function addEqRow(e,t){var n=EqArr.findIndex(t=>t==e.PropList);if(-1!=n)return!1;var a=document.createElement("div");a.setAttribute("class","alert alert-success eq_header"),a.setAttribute("style","position:relative"),a.setAttribute("data-PropList",e.PropList);var r=document.createElement("table");r.setAttribute("class","EqTableMain");var i=document.createElement("tr"),d=document.createElement("td"),l=document.createElement("button");l.setAttribute("class","ui-wrk-btn");var o='<span class="icn-md icon-down"></span>';l.innerHTML=o,l.setAttribute("onclick","$('#SLO_'"+e.PropList+").toggle()");var p=document.createElement("button");p.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra");o='<span class="icn-md fa fa-check-square-o"></span>';p.innerHTML=o;var u=document.createElement("button");u.setAttribute("class","ui-wrk-btn ui-wrk-btn-success");o='<span class="icn-md fa fa-plus"></span>';u.innerHTML=o,u.setAttribute("onclick","addRowCrs('"+e.PropList+"')");var s=document.createElement("button");s.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning");o='<span class="icn-md fa fa-edit"></span>';s.innerHTML=o;var m=document.createElement("button");m.setAttribute("class","ui-wrk-btn ui-wrk-btn-red");o='<span class="icn-md icon-remove"></span>';m.setAttribute("onclick","SeciliSil('"+e.PropList+"')"),m.innerHTML=o;var c=document.createElement("button");c.setAttribute("class","ui-wrk-btn "),c.setAttribute("style","background:#292424 !important;color:white"),c.setAttribute("onclick","SeperatorSil('"+e.PropList+"')"),c.innerHTML='<span class="icn-md fa fa-trash"></span>';var E=document.createElement("button");E.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),E.innerHTML='<span class="icn-md icon-filter"></span>',E.setAttribute("onclick","lookProducts('"+e.PropList+"')");var _=document.createElement("div");_.setAttribute("style","display:flex"),p.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),u.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),s.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),m.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),c.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),E.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),_.appendChild(p),_.appendChild(u),_.appendChild(s),_.appendChild(m),_.appendChild(c),_.appendChild(E);var C=document.createElement("input");C.id="SeperatorRC_"+e.PropList,C.name="SeperatorRC_"+e.PropList,C.type="hidden",C.value=1,d.appendChild(C),i.appendChild(d);var A=10;for(let t=0;t<e.Filters.length;t++){const n=e.Filters[t];d=document.createElement("td");d.setAttribute("style","border-right:solid 1px;width:"+A+"%");var O="<span style='font-weight:bold'>"+n.PNAME+"</span></br><span>"+n.PRODUCT_CAT+"</span>";d.innerHTML=O,i.appendChild(d)}var T=0,R=0;if(e.Filters.length<12){T=100-e.Filters.length*A,R=T;d=document.createElement("td");d.setAttribute("style","width:"+R+"%"),i.appendChild(d)}r.appendChild(i);C=document.createElement("input");C.setAttribute("type","hidden"),C.value=t,C.name="AddedEquipment",C.id="AddedEquipment_"+e.PropList,a.appendChild(C),a.appendChild(r);var b=document.createElement("div");b.setAttribute("style","background:white"),b.setAttribute("id","SLO_"+e.PropList);var h=document.createElement("table");h.setAttribute("class","SubSepet table");var I=document.createElement("thead");i=document.createElement("tr");i.appendChild(thCrate("#",!0)),i.appendChild(thCrate("Part No",!0)),i.appendChild(thCrate("Part Name",!0)),i.appendChild(thCrate("Quantity",!0)),i.appendChild(thCrate("Unit",!0)),i.appendChild(thCrate("Purchase Price",!1)),i.appendChild(thCrate("Sales Price",!0)),i.appendChild(thCrate("Sales Discount",!1)),i.appendChild(thCrate("Unit Price",!0)),i.appendChild(thCrate("Total Price",!1)),i.appendChild(thCrate("First Remark",!0)),i.appendChild(thCrate("Delivered Items",!1)),i.appendChild(thCrate("Weight",!0)),I.appendChild(i),h.appendChild(I),h.id="SubSepet_"+e.PropList;var v=document.createElement("tbody");v.id="SubSepetBody_"+e.PropList,h.appendChild(v),b.appendChild(h),a.appendChild(b);var S='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;display:none"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";S='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;display:none"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";S=$(S)[0],a.appendChild(S),document.getElementById("BasketArea").appendChild(a),EqArr.push(e.PropList)}function addRowCrs(e,t="",n="",a="",r,i="",d=1,l="",o=0,p="",u=0,s=0,m=0,c=0,E="",_=0,C=0,A=0,O=""){$("#SLO_"+e).show();var T=document.createElement("tr"),R=document.createElement("td");R.setAttribute("style","vertical-align:middle;font-weight:bold");var b=document.createElement("input");b.type="checkbox",b.name="CBX",b.id="CBX_"+RowCount,b.setAttribute("class","SatirSecCbx");var h=document.createElement("input");h.type="hidden",h.name="IS_VIRTUAL",h.id="IS_VIRTUAL_"+RowCount,h.value=A;var I=document.createElement("input");I.type="hidden",I.name="UNIQUE_RELATION_ID",I.id="UNIQUE_RELATION_ID_"+RowCount,O.length>0?I.value=O:I.value=GenerateUniqueId();var v=document.createElement("span");v.innerText=RowCount;var S=document.createElement("span"),g=document.getElementById("SeperatorRC_"+e).value;g=parseInt(g),S.innerText=g;var N=document.createElement("div");N.setAttribute("style","display:flex"),N.appendChild(h),N.appendChild(I),N.appendChild(v),g++,R.appendChild(N),T.appendChild(R),document.getElementById("SeperatorRC_"+e).value=g;R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");b=document.createElement("input");b.setAttribute("type","text"),b.name="PRODUCT_CODE_2",b.value=i,b.id="PRODUCT_CODE_2_"+RowCount,b.setAttribute("proplist",e),b.setAttribute("readonly","true"),N.appendChild(b);b=document.createElement("input");b.type="hidden",b.name="PRODUCT_ID",b.id="PRODUCT_ID_"+RowCount,b.value=t,N.appendChild(b);b=document.createElement("input");b.type="hidden",b.name="STOCK_ID",b.id="STOCK_ID_"+RowCount,b.value=n,N.appendChild(b);b=document.createElement("input");b.type="hidden",b.name="TAX",b.value=r,b.id="TAX_"+RowCount,N.appendChild(b),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");b=document.createElement("input");b.setAttribute("type","text"),b.name="PRODUCT_NAME",b.value=a,b.id="PRODUCT_NAME_"+RowCount,b.setAttribute("style","text-align:left"),N.appendChild(b),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");b=document.createElement("input");b.setAttribute("type","text"),b.name="QUANTITY",b.id="QUANTITY_"+RowCount,b.value=commaSplit(d),b.setAttribute("onchange","AlayiniHesapla()"),N.appendChild(b),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");b=document.createElement("select");var f=document.createElement("option");f.value=l,f.innerText=l,b.name="PRODUCT_UNIT",b.id="PRODUCT_UNIT_"+RowCount,b.appendChild(f),N.appendChild(b),R.appendChild(N),T.appendChild(R);R=document.createElement("td");R.setAttribute("style","display:none");N=document.createElement("div");N.setAttribute("class","form-group");var y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="PURCHASE_PRICE",b.id="PURCHASE_PRICE_"+RowCount,b.value=commaSplit(o),y.appendChild(b);b=document.createElement("select");0==p.length&&(p=OfferData.OTHER_MONEY),b.innerHTML=CreateOptionList(1,p),b.name="PURCHASE_MONEY",b.id="PURCHASE_MONEY_"+RowCount,b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="SALE_PRICE",b.id="SALE_PRICE_"+RowCount,b.value=commaSplit(u),b.setAttribute("onchange","AlayiniHesapla()"),y.appendChild(b);b=document.createElement("select");b.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),b.name="SALE_MONEY",b.id="SALE_MONEY_"+RowCount,b.setAttribute("disabled","yes"),b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td");R.setAttribute("style","display:none");N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="SALE_DISCOUNT",b.id="SALE_DISCOUNT_"+RowCount,b.value=commaSplit(s),b.setAttribute("onchange","AlayiniHesapla()"),y.appendChild(b);b=document.createElement("select");b.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),b.name="SALE_DISCOUNT_MONEY",b.setAttribute("disabled","yes"),b.id="SALE_DISCOUNT_MONEY_"+RowCount,b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="UNIT_PRICE",b.id="UNIT_PRICE_"+RowCount,b.value=commaSplit(m),b.setAttribute("readonly","yes"),y.appendChild(b);b=document.createElement("select");b.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),b.name="UNIT_PRICE_MONEY",b.id="UNIT_PRICE_MONEY_"+RowCount,b.setAttribute("class","input-group-text"),b.setAttribute("disabled","yes"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td");R.setAttribute("style","display:none");N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="TOTAL_PRICE",b.id="TOTAL_PRICE_"+RowCount,b.setAttribute("readonly","yes"),b.value=commaSplit(c),y.appendChild(b);b=document.createElement("select");b.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),b.name="TOTAL_PRICE_MONEY",b.id="TOTAL_PRICE_MONEY_"+RowCount,b.setAttribute("disabled","yes"),b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="FIRST_REMARK",b.value=E,b.id="FIRST_REMARK_"+RowCount,y.appendChild(b);b=document.createElement("span");b.setAttribute("class","input-group-addon btnPointer icon-remove"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td");R.setAttribute("style","display:none");N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="DELIVERED_ITEMS",b.id="DELIVERED_ITEMS_"+RowCount,b.value=commaSplit(_),y.appendChild(b);b=document.createElement("select");b.innerHTML="",b.name="DELIVERED_ITEMS_UNIT",b.id="DELIVERED_ITEMS_UNIT_"+RowCount,b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R);R=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");y=document.createElement("div");y.setAttribute("class","input-group"),y.setAttribute("style","display:flex");b=document.createElement("input");b.setAttribute("type","text"),b.name="WEIGHT",b.id="WEIGHT_"+RowCount,b.value=commaSplit(C),y.appendChild(b);b=document.createElement("select");b.innerHTML="",b.name="WEIGHT_UNIT",b.id="WEIGHT_UNIT_"+RowCount,b.setAttribute("class","input-group-text"),y.appendChild(b),N.appendChild(y),R.appendChild(N),T.appendChild(R),document.getElementById("SubSepetBody_"+e).appendChild(T),RowCount++}function thCrate(e,t){var n=document.createElement("th");return n.innerText=e,t?n.setAttribute("class","tablesorter-header tablesorter-headerUnSorted"):(n.setAttribute("class","tablesorter-header tablesorter-headerUnSorted"),n.setAttribute("style","display:none")),n}function CreateOptionList(e,t="EUR"){if(1==e){var n=wrk_safe_query("getMoneyList","dsn"),a=n.MONEY,r="";for(let e=0;e<a.length;e++){const n=a[e];r+=t==n?"<option  selected value='"+n+"'>"+n+"</option>":"<option  value='"+n+"'>"+n+"</option>"}$("ReturnStr");return r}}function AlayiniHesapla(){paraBirimleriniEsitle(),AktifSepet=[],OrderFooter={total_default:0,genel_indirim_:0,total_discount_wanted:0,brut_total_wanted:0,total_tax_wanted:0,net_total_wanted:0,other_money:"TL"};var e=document.getElementById("BasketArea").children;for(let $=0;$<e.length;$++){var t=e[$],n=t.getAttribute("data-proplist"),a=document.getElementById("AddedEquipment_"+n).value,r=JSON.parse(a),i=document.getElementById("SubSepetBody_"+n),d=0,l=i.children.length;document.getElementById("RC_"+n).innerText=l;var o=0,p=KurGetir(document.getElementById("MONEY").value);for(let e=0;e<i.children.length;e++){var u=i.children[e];o++;var s=DegeriGetir(u,"PRODUCT_ID",1),m=DegeriGetir(u,"IS_VIRTUAL",1),c=DegeriGetir(u,"PRODUCT_NAME",0),E=DegeriGetir(u,"PRODUCT_CODE_2",0),_=0;0==OfferSettings.IS_TAX_ZERO&&(_=DegeriGetir(u,"TAX",2,0));var C=DegeriGetir(u,"STOCK_ID",1),A=DegeriGetir(u,"QUANTITY",2,1),O=DegeriGetir(u,"PRODUCT_UNIT",0),T=DegeriGetir(u,"PURCHASE_PRICE",2,1),R=DegeriGetir(u,"PURCHASE_MONEY",0),b=DegeriGetir(u,"SALE_PRICE",2,1),h=DegeriGetir(u,"SALE_MONEY",0),I=document.getElementById("GENERAL_DISCOUNT").value,v=parseFloat(filterNum(commaSplit(I))),S=b*v/100;DegerYaz(u,"SALE_DISCOUNT",2,S);var g=DegeriGetir(u,"SALE_DISCOUNT",2,1),N=DegeriGetir(u,"UNIQUE_RELATION_ID",0),f=DegeriGetir(u,"SALE_DISCOUNT_MONEY",0,0),y=DegeriGetir(u,"TOTAL_PRICE_MONEY",0,0),L=b-g;DegerYaz(u,"UNIT_PRICE",2,L);var w=0;if(p.MONEY==y)w=L*A;else{var P=MONEY_ARR.findIndex(e=>e.MONEY==y),D=MONEY_ARR[P],M=p.RATE2/D.RATE2;w=L*A*M}var U=b,x=b*p.RATE2;DegerYaz(u,"TOTAL_PRICE",2,w);var Y=L*A*p.RATE2,F=Y*_/100,H=Y+F,B={PRODUCT_ID:s,STOCK_ID:C,PRODUCT_NAME:c,PRODUCT_CODE_2:E,AMOUNT:A,PRICE_OTHER:U,PRICE:x,OTHER_MONEY:OfferData.OTHER_MONEY,OTHER_MONEY_VALUE:w,DISCOUNT_COST:g,TL_TOTAL_PRICE:Y,PRODUCT_UNIT:O,PURCHASE_PRICE:T,PURCHASE_MONEY:R,SALE_PRICE:b,SALE_PRICE:b,SALE_MONEY:h,IS_VIRTUAL:m,UNIQUE_RELATION_ID:N,SALE_DISCOUNT:g,PROP_LIST:n,JSON_STRINGIM:r,SALE_DISCOUNT_MONEY:f,UNIT_PRICE:L,TOTAL_PRICE:w,TOTAL_PRICE_MONEY:y,TAX_RATE:_,TAX:F,WITH_TAX:H,RATE2:p.RATE2,SEPET_SIRA:o};if(B.TLF=B.OTHER_MONEY_VALUE*p.RATE2,B.TOTAL_PRICE_MONEY==p.MONEY)d+=B.TOTAL_PRICE;else{var k=MONEY_ARR.findIndex(e=>e.MONEY==B.TOTAL_PRICE_MONEY),G=MONEY_ARR[k].RATE2;d+=B.TOTAL_PRICE*G}OrderFooter.total_default+=B.PRICE_OTHER*A,OrderFooter.total_discount_wanted+=B.PRICE_OTHER*B.AMOUNT-B.UNIT_PRICE*B.AMOUNT,AktifSepet.push(B)}OrderFooter.TOTAL_PRICE+=d}var $=document.getElementById("genel_indirim_").value;$.length>0?($=filterNum(commaSplit($)),$=parseFloat($),document.getElementById("genel_indirim_").value=commaSplit($),OrderFooter.genel_indirim_=$):(document.getElementById("genel_indirim_").value=commaSplit(0),$=0,OrderFooter.genel_indirim_=$),OrderFooter.total_discount_wanted+=$,OrderFooter.brut_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted,OrderFooter.total_tax_wanted=0,OrderFooter.net_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted+OrderFooter.total_tax_wanted,OzetOlustur()}function KurGetir(e){var t=MONEY_ARR.findIndex(t=>t.MONEY==e);return MONEY_ARR[t]}function DegeriGetir(e,t,n=0,a=0){var r=$(e).find("input[name='"+t+"']").val(),i=0;if(r)0==n?i=r:1==n?i=parseInt(r):2==n&&(i=parseFloat(filterNum(commaSplit(r)))),1==a&&(2!=n&&1!=n||$(e).find("input[name='"+t+"']").val(commaSplit(i)));else{r=$(e).find("select[name='"+t+"']").val();0==n?i=r:1==n?i=parseInt(r):2==n&&(i=parseFloat(filterNum(commaSplit(r))))}return i}function DegerYaz(e,t,n=0,a){console.log(arguments);var r=$(e).find("input[name='"+t+"']")[0];console.log(r);var i=0;r?0==n?i=a:1==n?i=commaSplit(a):2==n&&(i=commaSplit(a)):(r=$(e).find("select[name='"+t+"']")[0],0==n?i=a:1==n?i=parseInt(a):2==n&&(i=parseFloat(filterNum(commaSplit(a))))),console.log(i),$(r).val(i)}function OzetOlustur(){var e=KurGetir(document.getElementById("MONEY").value);$("#brut_total_wanted").val(commaSplit(OrderFooter.brut_total_wanted)),$("#brut_total_wanted_").val(commaSplit(OrderFooter.brut_total_wanted*e.RATE2)),$("#genel_indirim_").val(commaSplit(OrderFooter.genel_indirim_)),$("#genel_indirim__").val(commaSplit(OrderFooter.genel_indirim_*e.RATE2)),$("#net_total_wanted").val(commaSplit(OrderFooter.net_total_wanted)),$("#net_total_wanted_").val(commaSplit(OrderFooter.net_total_wanted*e.RATE2)),$("#total_default").val(commaSplit(OrderFooter.total_default)),$("#total_default_").val(commaSplit(OrderFooter.total_default*e.RATE2)),$("#total_discount_wanted").val(commaSplit(OrderFooter.total_discount_wanted)),$("#total_discount_wanted_").val(commaSplit(OrderFooter.total_discount_wanted*e.RATE2)),$("#total_tax_wanted").val(commaSplit(OrderFooter.total_tax_wanted)),$("#total_tax_wanted_").val(commaSplit(OrderFooter.total_tax_wanted*e.RATE2)),OrderFooter.brut_total_wanted_=OrderFooter.brut_total_wanted*e.RATE2,OrderFooter.genel_indirim__=OrderFooter.genel_indirim_*e.RATE2,OrderFooter.net_total_wanted_=OrderFooter.net_total_wanted*e.RATE2,OrderFooter.total_default_=OrderFooter.total_default*e.RATE2,OrderFooter.total_discount_wanted_=OrderFooter.total_discount_wanted*e.RATE2,OrderFooter.total_tax_wanted_=OrderFooter.total_tax_wanted*e.RATE2}function indirimYuzdeHesap(){var e=document.getElementById("GENERAL_DISCOUNT").value,t=parseFloat(filterNum(commaSplit(e))),n=document.getElementsByClassName("SubSepet");for(let e=0;e<n.length;e++){var a=n[e].tBodies[e].children;for(let e=0;e<a.length;e++){var r=document.getElementById("SALE_PRICE_"+(e+1)).value;r=parseFloat(filterNum(commaSplit(r))),console.log(r);var i=r*t/100;console.log(i),document.getElementById("SALE_DISCOUNT_"+(e+1)).value=commaSplit(i),AlayiniHesapla()}}}function SaveOffer(){AlayiniHesapla();var e=new Object;e.OFFER_HEADER=OfferData,e.ROWS=AktifSepet,e.OFFER_FOOTER=OrderFooter,console.log(e)}function paraBirimleriniEsitle(){var e=document.getElementsByName("SALE_MONEY"),t=document.getElementsByName("UNIT_PRICE_MONEY"),n=document.getElementsByName("SALE_DISCOUNT_MONEY"),a=document.getElementsByName("TOTAL_PRICE_MONEY");for(let r=0;r<e.length;r++)e[r].value=document.getElementById("MONEY").value,t[r].value=document.getElementById("MONEY").value,n[r].value=document.getElementById("MONEY").value,a[r].value=document.getElementById("MONEY").value}var AktifSepet=[],OfferSettings={IS_TAX_ZERO:1},EqArr=[],RowCount=1;