function getCats(e){$.ajax({url:ServiceUri+"/ProductService.cfc?method=getCats",success:function(t){var n=JSON.parse(t);$(e).html("");for(let t=0;t<n.length;t++){var a=document.createElement("option");a.value=n[t].PRODUCT_CATID,a.innerText=n[t].PRODUCT_CAT,e.appendChild(a)}}})}function getCatProperties(e){try{$("#BUTOCUMMMMM").remove()}catch{}var t=document.getElementById("WESSEL_ID").value;if(t.length>0)$.post(ServiceUri+"/OfferService.cfc?method=getShipFilters&SHIP_ID="+t+"&PRODUCT_CATID="+e).done(function(n){var a=JSON.parse(n);if(1==a.STATUS){var r=confirm("Bu Gemi'de Bu Ekipmana Bağlı Filtreler Kayıt Edilmiştir Yüklemek İstermisiniz"),o=document.createElement("a");o.setAttribute("class","input-group-addon"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+t+"&cat_id="+e+"')"),o.id="BUTOCUMMMMM";var l=document.createElement("span");l.setAttribute("class","icn-md fa fa-gears"),o.appendChild(l),document.getElementById("PRODUCT_CAT").parentElement.appendChild(o),r?1==a.RECORD_COUNT?(addEqRow(a.JSON_STRINGIM,JSON.stringify(a.JSON_STRINGIM)),AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")):(openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+t+"&cat_id="+e),AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")):AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")}else AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")});else AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")}function AddEquipment(){var e=getFilterData(),t=e.ReturnObject,n=e.jsn;addEqRow(t,n)}function getFilterData(){var e=document.getElementById("PRODUCT_CAT"),t=e.options.selectedIndex,n=e.options[t].innerText,a=e.options[t].value,r={PRODUCT_CAT:n,PRODUCT_CAT_ID:a},o=[],l={PRODUCT_CAT:n,PRODUCT_CAT_ID:a,PNAME:"EQUIPMENT",PROP_ID:0,IS_OPTIONAL:0};o.push(l);var d=document.getElementsByClassName("propss"),i="";i+=a;var u=0;for(let e=0;e<d.length;e++){var m=d[e],c=m.getAttribute("required"),_=$(m).select2("data")[0],p=_.element.parentElement.getAttribute("data-property_id"),E=_.element.parentElement.getAttribute("data-is_optional");console.log(E);n=_.text,a=_.id;var s=_.title;if(_.id.length>0){var T={PRODUCT_CAT:n,PRODUCT_CAT_ID:a,PNAME:s,PROP_ID:p,IS_OPTIONAL:E};o.push(T),i+=","+a}"true"==c&&0==_.id.length&&u++}r.Filters=o,r.PropList=i;var C=JSON.stringify(r);if(console.log(r),u>0)return alert("Zorunlu Alanlar var !"),!1;var I=new Object;return I.ReturnObject=r,I.jsn=C,I}function addEqRow(e,t){var n=EqArr.findIndex(t=>t==e.PropList);if(-1!=n)return!1;var a=document.createElement("div");a.setAttribute("class","alert alert-success eq_header"),a.setAttribute("style","position:relative"),a.setAttribute("data-PropList",e.PropList);var r=document.createElement("table");r.setAttribute("class","EqTableMain");var o=document.createElement("tr"),l=document.createElement("td"),d=document.createElement("button");d.setAttribute("class","ui-wrk-btn");var i='<span class="icn-md icon-down"></span>';d.innerHTML=i,d.setAttribute("onclick","$('#SLO_'"+e.PropList+").toggle()");var u=document.createElement("button");u.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra");i='<span class="icn-md fa fa-check-square-o"></span>';u.innerHTML=i;var m=document.createElement("button");m.setAttribute("class","ui-wrk-btn ui-wrk-btn-success");i='<span class="icn-md fa fa-plus"></span>';m.innerHTML=i,m.setAttribute("onclick","addRowCrs('"+e.PropList+"')");var c=document.createElement("button");c.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning");i='<span class="icn-md fa fa-edit"></span>';c.innerHTML=i;var _=document.createElement("button");_.setAttribute("class","ui-wrk-btn ui-wrk-btn-red");i='<span class="icn-md icon-remove"></span>';_.setAttribute("onclick","SeciliSil('"+e.PropList+"')"),_.innerHTML=i;var p=document.createElement("button");p.setAttribute("class","ui-wrk-btn "),p.setAttribute("style","background:#292424 !important;color:white"),p.setAttribute("onclick","SeperatorSil('"+e.PropList+"')"),p.innerHTML='<span class="icn-md fa fa-trash"></span>';var E=document.createElement("button");E.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),E.innerHTML='<span class="icn-md icon-filter"></span>',E.setAttribute("onclick","lookProducts('"+e.PropList+"')");var s=document.createElement("div");s.setAttribute("style","display:flex"),u.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),m.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),c.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),_.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),p.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),E.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),s.appendChild(u),s.appendChild(m),s.appendChild(c),s.appendChild(_),s.appendChild(p),s.appendChild(E),l.appendChild(s);var T=document.createElement("input");T.id="SeperatorRC_"+e.PropList,T.name="SeperatorRC_"+e.PropList,T.type="hidden",T.value=1,l.appendChild(T),o.appendChild(l);var C=8;for(let t=0;t<e.Filters.length;t++){const n=e.Filters[t];l=document.createElement("td");l.setAttribute("style","border-right:solid 1px;width:"+C+"%");var I="<span style='font-weight:bold'>"+n.PNAME+"</span></br><span>"+n.PRODUCT_CAT+"</span>";l.innerHTML=I,o.appendChild(l)}var O=0,A=0;if(e.Filters.length<12){O=12-e.Filters.length,A=8*O;l=document.createElement("td");l.setAttribute("style","width:"+A+"%"),o.appendChild(l)}r.appendChild(o);T=document.createElement("input");T.setAttribute("type","hidden"),T.value=t,T.name="AddedEquipment",T.id="AddedEquipment_"+e.PropList,a.appendChild(T),a.appendChild(r);var R=document.createElement("div");R.setAttribute("style","background:white"),R.setAttribute("id","SLO_"+e.PropList);var g=document.createElement("table");g.setAttribute("class","SubSepet table");var D=document.createElement("thead");o=document.createElement("tr");o.appendChild(thCrate("#")),o.appendChild(thCrate("Part No")),o.appendChild(thCrate("Part Name")),o.appendChild(thCrate("Quantity")),o.appendChild(thCrate("Unit")),o.appendChild(thCrate("Purchase Price")),o.appendChild(thCrate("Sales Price")),o.appendChild(thCrate("Sales Discount")),o.appendChild(thCrate("Unit Price")),o.appendChild(thCrate("Total Price")),o.appendChild(thCrate("First Remark")),o.appendChild(thCrate("Delivered Items")),o.appendChild(thCrate("Weight")),D.appendChild(o),g.appendChild(D),g.id="SubSepet_"+e.PropList;var P=document.createElement("tbody");P.id="SubSepetBody_"+e.PropList,g.appendChild(P),R.appendChild(g),a.appendChild(R);var S='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";S='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";S=$(S)[0],a.appendChild(S),document.getElementById("BasketArea").appendChild(a),EqArr.push(e.PropList)}function addRowCrs(e,t="",n="",a="",r,o="",l=1,d="",i=0,u="",m=0,c=0,_=0,p=0,E="",s=0,T=0,C=0,I=""){$("#SLO_"+e).show();var O=document.createElement("tr"),A=document.createElement("td"),R=document.createElement("input");R.type="checkbox",R.name="CBX",R.id="CBX_"+RowCount,R.setAttribute("class","SatirSecCbx");var g=document.createElement("input");g.type="hidden",g.name="IS_VIRTUAL",g.id="IS_VIRTUAL_"+RowCount,g.value=C;var D=document.createElement("input");D.type="hidden",D.name="UNIQUE_RELATION_ID",D.id="UNIQUE_RELATION_ID_"+RowCount,I.length>0?D.value=I:D.value=GenerateUniqueId();var P=document.createElement("button");P.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning"),P.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),P.innerText=RowCount;var S=document.createElement("button");S.setAttribute("class","ui-wrk-btn ui-wrk-btn-success"),S.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");var b=document.createElement("button");b.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),b.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");var v=document.createElement("span");v.setAttribute("class","icn-md fa fa-info"),b.appendChild(v);var f=document.createElement("button");f.setAttribute("class","ui-wrk-btn ui-wrk-btn-busy"),f.setAttribute("id","ResimButonC_"+RowCount),f.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");v=document.createElement("span");v.setAttribute("class","icn-md fa fa-camera"),f.appendChild(v);var y=document.createElement("button");y.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning"),y.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");v=document.createElement("span");v.setAttribute("class","icn-md fa fa-dashboard"),y.appendChild(v);var h=document.getElementById("SeperatorRC_"+e).value;h=parseInt(h),S.innerText=h,S.setAttribute("onclick","MoveRow("+h+")"),b.setAttribute("onclick","ShowProperties(this)"),b.setAttribute("data-rc",RowCount),f.setAttribute("onclick","ShowImages(this)"),f.setAttribute("data-rc",RowCount),y.setAttribute("onclick","open_product_popup(this)"),y.setAttribute("data-rc",RowCount);var N=document.createElement("div");N.setAttribute("style","display:flex"),N.appendChild(R),N.appendChild(g),N.appendChild(D),N.appendChild(P),N.appendChild(S),N.appendChild(b),N.appendChild(f),N.appendChild(y),h++,A.appendChild(N),O.appendChild(A),document.getElementById("SeperatorRC_"+e).value=h;A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");R=document.createElement("input");R.setAttribute("type","text"),R.name="PRODUCT_CODE_2",R.value=o,R.id="PRODUCT_CODE_2_"+RowCount,R.setAttribute("proplist",e),1==C?R.setAttribute("style","color:red;font-weight:bold;text-align:left;background:black;"):R.setAttribute("style","text-align:left"),R.setAttribute("onchange","getProduct(this,"+RowCount+")"),N.appendChild(R);R=document.createElement("input");R.type="hidden",R.name="PRODUCT_ID",R.id="PRODUCT_ID_"+RowCount,R.value=t,N.appendChild(R);R=document.createElement("input");R.type="hidden",R.name="STOCK_ID",R.id="STOCK_ID_"+RowCount,R.value=n,N.appendChild(R);R=document.createElement("input");R.type="hidden",R.name="TAX",R.value=r,R.id="TAX_"+RowCount,N.appendChild(R),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");R=document.createElement("input");R.setAttribute("type","text"),R.name="PRODUCT_NAME",R.value=a,R.id="PRODUCT_NAME_"+RowCount,R.setAttribute("style","text-align:left"),N.appendChild(R),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");R=document.createElement("input");R.setAttribute("type","text"),R.name="QUANTITY",R.id="QUANTITY_"+RowCount,R.value=commaSplit(l),R.setAttribute("onchange","AlayiniHesapla()"),N.appendChild(R),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");R=document.createElement("select");var U=document.createElement("option");U.value=d,U.innerText=d,R.name="PRODUCT_UNIT",R.id="PRODUCT_UNIT_"+RowCount,R.appendChild(U),N.appendChild(R),A.appendChild(N),O.appendChild(A),I.length;A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");var B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.setAttribute("readonly","yes"),R.name="PURCHASE_PRICE",R.id="PURCHASE_PRICE_"+RowCount,0!=i&&R.setAttribute("style","color:green"),R.value=commaSplit(i),B.appendChild(R);R=document.createElement("select");0==u.length&&(u=OfferData.OTHER_MONEY),R.innerHTML=CreateOptionList(1,u),R.name="PURCHASE_MONEY",R.id="PURCHASE_MONEY_"+RowCount,R.setAttribute("class","input-group-text"),R.setAttribute("disabled","disabled"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="SALE_PRICE",R.id="SALE_PRICE_"+RowCount,R.value=commaSplit(m),R.setAttribute("onchange","AlayiniHesapla()"),B.appendChild(R);R=document.createElement("select");R.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),R.name="SALE_MONEY",R.id="SALE_MONEY_"+RowCount,R.setAttribute("disabled","yes"),R.setAttribute("class","input-group-text"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="SALE_DISCOUNT",R.id="SALE_DISCOUNT_"+RowCount,R.value=commaSplit(c),R.setAttribute("onchange","AlayiniHesapla()"),B.appendChild(R);R=document.createElement("select");R.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),R.name="SALE_DISCOUNT_MONEY",R.setAttribute("disabled","yes"),R.id="SALE_DISCOUNT_MONEY_"+RowCount,R.setAttribute("class","input-group-text"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="UNIT_PRICE",R.id="UNIT_PRICE_"+RowCount,R.value=commaSplit(_),R.setAttribute("readonly","yes"),B.appendChild(R);R=document.createElement("select");R.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),R.name="UNIT_PRICE_MONEY",R.id="UNIT_PRICE_MONEY_"+RowCount,R.setAttribute("class","input-group-text"),R.setAttribute("disabled","yes"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="TOTAL_PRICE",R.id="TOTAL_PRICE_"+RowCount,R.setAttribute("readonly","yes"),R.value=commaSplit(p),B.appendChild(R);R=document.createElement("select");R.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),R.name="TOTAL_PRICE_MONEY",R.id="TOTAL_PRICE_MONEY_"+RowCount,R.setAttribute("disabled","yes"),R.setAttribute("class","input-group-text"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="FIRST_REMARK",R.value=E,R.id="FIRST_REMARK_"+RowCount,B.appendChild(R);R=document.createElement("span");R.setAttribute("class","input-group-addon btnPointer icon-remove"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="DELIVERED_ITEMS",R.id="DELIVERED_ITEMS_"+RowCount,R.value=commaSplit(s),B.appendChild(R);R=document.createElement("select");R.innerHTML="",R.name="DELIVERED_ITEMS_UNIT",R.id="DELIVERED_ITEMS_UNIT_"+RowCount,R.setAttribute("class","input-group-text"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A);A=document.createElement("td"),N=document.createElement("div");N.setAttribute("class","form-group");B=document.createElement("div");B.setAttribute("class","input-group"),B.setAttribute("style","display:flex");R=document.createElement("input");R.setAttribute("type","text"),R.name="WEIGHT",R.id="WEIGHT_"+RowCount,R.value=commaSplit(T),B.appendChild(R);R=document.createElement("select");R.innerHTML="",R.name="WEIGHT_UNIT",R.id="WEIGHT_UNIT_"+RowCount,R.setAttribute("class","input-group-text"),B.appendChild(R),N.appendChild(B),A.appendChild(N),O.appendChild(A),document.getElementById("SubSepetBody_"+e).appendChild(O),RowCount++}function thCrate(e){var t=document.createElement("th");return t.innerText=e,t.setAttribute("class","tablesorter-header tablesorter-headerUnSorted"),t}function getProduct(e,t){var n=e.value,a=document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist"),r=document.getElementById("AddedEquipment_"+a).value;r=JSON.parse(r);var o={SearchMainValue:r,keyword:n};$.ajax({url:ServiceUri+"/ProductService.cfc?method=SearchProduct",data:{FormData:JSON.stringify(o)},success:function(n){var r=JSON.parse(n);if(r.RECORD_COUNT>=1){if(r.RECORD_COUNT>1){e.setAttribute("style","color:orange;font-weight:bold;text-align:left;");var o=document.createElement("button");o.setAttribute("class","btn btn-warning"),o.innerHTML="<i class='icn-md fa fa-search'></i>",e.parentElement.appendChild(o),e.parentElement.setAttribute("style","display:flex"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=getCollation&rc="+t+"&kw="+e.value+"&prp_list="+a+"')")}else if(r.EXTRA_PROPT>0){e.setAttribute("style","color:green;font-weight:bold;text-align:left;background:black");o=document.createElement("button");o.setAttribute("class","btn btn-success"),o.innerHTML="<i class='icn-md fa fa-search'></i>",e.parentElement.appendChild(o),e.parentElement.setAttribute("style","display:flex"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=ShowProductProperties&rc="+t+"&PID="+r.PRODUCT_ID+"&prp_list="+a+"')")}else e.setAttribute("style","color:green;font-weight:bold;text-align:left;");document.getElementById("PRODUCT_NAME_"+t).value=r.PRODUCT_NAME,r.IMG_COUNT>0&&document.getElementById("ResimButonC_"+t).setAttribute("class","ui-wrk-btn ui-wrk-btn-red"),document.getElementById("PRODUCT_ID_"+t).value=r.PRODUCT_ID,document.getElementById("IS_VIRTUAL_"+t).value=r.IS_VIRTUAL,document.getElementById("STOCK_ID_"+t).value=r.STOCK_ID,document.getElementById("TAX_"+t).value=r.TAX,document.getElementById("QUANTITY_"+t).value=commaSplit(1),document.getElementById("PRODUCT_UNIT_"+t).innerHTML='<option value="'+r.MAIN_UNIT+'">'+r.MAIN_UNIT+"</option>",document.getElementById("PURCHASE_PRICE_"+t).value=commaSplit(0),document.getElementById("SALE_PRICE_"+t).value=commaSplit(0),document.getElementById("SALE_DISCOUNT_"+t).value=commaSplit(0),document.getElementById("UNIT_PRICE_"+t).value=commaSplit(0),document.getElementById("TOTAL_PRICE_"+t).value=commaSplit(0),document.getElementById("DELIVERED_ITEMS_"+t).value=commaSplit(0),document.getElementById("DELIVERED_ITEMS_UNIT_"+t).innerHTML='<option value="'+r.MAIN_UNIT+'">'+r.MAIN_UNIT+"</option>",AlayiniHesapla(),document.getElementById("WEIGHT_"+t).value=commaSplit(0)}else{e.setAttribute("style","color:red;font-weight:bold;text-align:left;background:black"),document.getElementById("IS_VIRTUAL_"+t).value=1,document.getElementById("PRODUCT_ID_"+t).value=0,document.getElementById("STOCK_ID_"+t).value=0;var l=wrk_safe_query("getAllUnits","dsn");for(let e=0;e<l.recordcount;e++){var d=document.createElement("option");d.value=l.UNIT[e],d.innerText=l.UNIT[e],document.getElementById("PRODUCT_UNIT_"+t).appendChild(d)}}}})}function MoveRow(e){var t=prompt("To Row"),n=document.getElementById("STOCK_ID_"+e).value,a=document.getElementById("STOCK_ID_"+t).value,r=document.getElementById("PRODUCT_ID_"+e).value,o=document.getElementById("PRODUCT_ID_"+t).value,l=document.getElementById("PRODUCT_CODE_2_"+e).value,d=document.getElementById("PRODUCT_CODE_2_"+t).value,i=document.getElementById("TAX_"+e).value,u=document.getElementById("TAX_"+t).value,m=document.getElementById("PRODUCT_NAME_"+e).value,c=document.getElementById("PRODUCT_NAME_"+t).value,_=document.getElementById("QUANTITY_"+e).value,p=document.getElementById("QUANTITY_"+t).value,E=document.getElementById("PRODUCT_UNIT_"+e).value,s=document.getElementById("PRODUCT_UNIT_"+t).value,T=document.getElementById("PURCHASE_PRICE_"+e).value,C=document.getElementById("PURCHASE_PRICE_"+t).value,I=document.getElementById("PURCHASE_MONEY_"+e).value,O=document.getElementById("PURCHASE_MONEY_"+t).value,A=document.getElementById("SALE_PRICE_"+e).value,R=document.getElementById("SALE_PRICE_"+t).value,g=document.getElementById("SALE_MONEY_"+e).value,D=document.getElementById("SALE_MONEY_"+t).value,P=document.getElementById("SALE_DISCOUNT_"+e).value,S=document.getElementById("SALE_DISCOUNT_"+t).value,b=document.getElementById("SALE_DISCOUNT_MONEY_"+e).value,v=document.getElementById("SALE_DISCOUNT_MONEY_"+t).value,f=document.getElementById("UNIT_PRICE_"+e).value,y=document.getElementById("UNIT_PRICE_"+t).value,h=document.getElementById("UNIT_PRICE_MONEY_"+e).value,N=document.getElementById("UNIT_PRICE_MONEY_"+t).value,U=document.getElementById("TOTAL_PRICE_"+e).value,B=document.getElementById("TOTAL_PRICE_"+t).value,M=document.getElementById("TOTAL_PRICE_MONEY_"+e).value,w=document.getElementById("TOTAL_PRICE_MONEY_"+t).value,x=document.getElementById("FIRST_REMARK_"+e).value,L=document.getElementById("FIRST_REMARK_"+t).value,Y={FromRowData:{ROW_ID:e,STOCK_ID:n,PRODUCT_ID:r,PRODUCT_CODE:l,TAX:i,PRODUCT_NAME:m,QUANTITY:_,UNIT:E,PURCHASE_PRICE:T,PURCHASE_MONEY:I,SALE_PRICE:A,SALE_MONEY:g,SALE_DISCOUNT:P,SALE_DISCOUNT_MONEY:b,UNIT_PRICE:f,UNIT_PRICE_MONEY:h,TOTAL_PRICE:U,TOTAL_PRICE_MONEY:M,FIRST_REMARK:x},ToRowData:{ROW_ID:t,STOCK_ID:a,PRODUCT_ID:o,PRODUCT_CODE:d,TAX:u,PRODUCT_NAME:c,QUANTITY:p,UNIT:s,PURCHASE_PRICE:C,PURCHASE_MONEY:O,SALE_PRICE:R,SALE_MONEY:D,SALE_DISCOUNT:S,SALE_DISCOUNT_MONEY:v,UNIT_PRICE:y,UNIT_PRICE_MONEY:N,TOTAL_PRICE:B,TOTAL_PRICE_MONEY:w,FIRST_REMARK:L}};document.getElementById("STOCK_ID_"+e).value=Y.ToRowData.STOCK_ID,document.getElementById("STOCK_ID_"+t).value=Y.FromRowData.STOCK_ID,document.getElementById("PRODUCT_ID_"+e).value=Y.ToRowData.PRODUCT_ID,document.getElementById("PRODUCT_ID_"+t).value=Y.FromRowData.PRODUCT_ID,document.getElementById("PRODUCT_CODE_2_"+e).value=Y.ToRowData.PRODUCT_CODE,document.getElementById("PRODUCT_CODE_2_"+t).value=Y.FromRowData.PRODUCT_CODE,document.getElementById("TAX_"+e).value=Y.ToRowData.TAX,document.getElementById("TAX_"+t).value=Y.FromRowData.TAX,document.getElementById("PRODUCT_NAME_"+e).value=Y.ToRowData.PRODUCT_NAME,document.getElementById("PRODUCT_NAME_"+t).value=Y.FromRowData.PRODUCT_NAME,document.getElementById("QUANTITY_"+e).value=Y.ToRowData.QUANTITY,document.getElementById("QUANTITY_"+t).value=Y.FromRowData.QUANTITY,document.getElementById("PRODUCT_UNIT_"+e).value=Y.ToRowData.UNIT,document.getElementById("PRODUCT_UNIT_"+t).value=Y.FromRowData.UNIT,document.getElementById("PURCHASE_PRICE_"+e).value=Y.ToRowData.PURCHASE_PRICE,document.getElementById("PURCHASE_PRICE_"+t).value=Y.FromRowData.PURCHASE_PRICE,document.getElementById("PURCHASE_MONEY_"+e).value=Y.ToRowData.PURCHASE_MONEY,document.getElementById("PURCHASE_MONEY_"+t).value=Y.FromRowData.PURCHASE_MONEY,document.getElementById("SALE_PRICE_"+e).value=Y.ToRowData.SALE_PRICE,document.getElementById("SALE_PRICE_"+t).value=Y.FromRowData.SALE_PRICE,document.getElementById("SALE_MONEY_"+e).value=Y.ToRowData.SALE_MONEY,document.getElementById("SALE_MONEY_"+t).value=Y.FromRowData.SALE_MONEY,document.getElementById("SALE_DISCOUNT_"+e).value=Y.ToRowData.SALE_DISCOUNT,document.getElementById("SALE_DISCOUNT_"+t).value=Y.FromRowData.SALE_DISCOUNT,document.getElementById("SALE_DISCOUNT_MONEY_"+e).value=Y.ToRowData.SALE_DISCOUNT_MONEY,document.getElementById("SALE_DISCOUNT_MONEY_"+t).value=Y.FromRowData.SALE_DISCOUNT_MONEY,document.getElementById("UNIT_PRICE_"+e).value=Y.ToRowData.UNIT_PRICE,document.getElementById("UNIT_PRICE_"+t).value=Y.FromRowData.UNIT_PRICE,document.getElementById("UNIT_PRICE_MONEY_"+e).value=Y.ToRowData.UNIT_PRICE_MONEY,document.getElementById("UNIT_PRICE_MONEY_"+t).value=Y.FromRowData.UNIT_PRICE_MONEY,document.getElementById("TOTAL_PRICE_"+e).value=Y.ToRowData.TOTAL_PRICE,document.getElementById("TOTAL_PRICE_"+t).value=Y.FromRowData.TOTAL_PRICE,document.getElementById("TOTAL_PRICE_MONEY_"+e).value=Y.ToRowData.TOTAL_PRICE_MONEY,document.getElementById("TOTAL_PRICE_MONEY_"+t).value=Y.FromRowData.TOTAL_PRICE_MONEY,document.getElementById("FIRST_REMARK_"+e).value=Y.ToRowData.FIRST_REMARK,document.getElementById("FIRST_REMARK_"+t).value=Y.FromRowData.FIRST_REMARK,AlayiniHesapla()}function SeperatorSil(e="7,50014,50015"){var t=document.getElementById("BasketArea"),n=t.children;for(let t=0;t<n.length;t++){var a=n[t],r=a.getAttribute("data-proplist");r==e&&a.remove()}TumSatirlariDuzenle(),AlayiniHesapla()}function TumSatirlariDuzenle(){var e=1,t=document.getElementById("BasketArea"),n=t.children;for(let t=0;t<n.length;t++){var a=n[t],r=a.getAttribute("data-proplist"),o=document.getElementById("SubSepetBody_"+r).children;for(let t=0;t<o.length;t++){var l=o[t],d=l.getElementsByTagName("input"),i=l.getElementsByTagName("select"),u=l.getElementsByTagName("button");for(let t=0;t<d.length;t++){var m=d[t];m.id=m.name+"_"+e}for(let t=0;t<i.length;t++){m=i[t];m.id=m.name+"_"+e}for(let t=0;t<u.length;t++){m=u[t];var c=m.getAttribute("onclick");c||(m.innerText=e)}e++}}RowCount=e}function SeciliSil(e="7,50014,50015"){var t=document.getElementById("SubSepetBody_"+e).children;for(let e=0;e<t.length;e++){var n=t[e],a=$(n).find("input[type='checkbox']")[0];$(a).is(":checked")&&n.remove()}var r=0;t=document.getElementById("SubSepetBody_"+e).children;for(let e=0;e<t.length;e++){r++;var o=t[e],l=o.getElementsByTagName("button");console.log(l);for(let e=0;e<l.length;e++){var d=l[e],i=d.getAttribute("onclick");i&&(console.log("BTNATT="+i),d.innerText=r)}}0==r&&(r=1),document.getElementById("SeperatorRC_"+e).value=r,TumSatirlariDuzenle(),AlayiniHesapla()}function CreateOptionList(e,t="EUR"){if(1==e){var n=wrk_safe_query("getMoneyList","dsn"),a=n.MONEY,r="";for(let e=0;e<a.length;e++){const n=a[e];r+=t==n?"<option  selected value='"+n+"'>"+n+"</option>":"<option  value='"+n+"'>"+n+"</option>"}$("ReturnStr");return r}}function UpdateRow(e,t,n,a,r,o,l){document.getElementById("PRODUCT_ID_"+o).value=e,document.getElementById("TAX_"+o).value=n,document.getElementById("STOCK_ID_"+o).value=t,document.getElementById("PRODUCT_CODE_2_"+o).value=a,document.getElementById("PRODUCT_NAME_"+o).value=r,document.getElementById("PRODUCT_CODE_2_"+o).setAttribute("style","color:green;font-weight:bold;text-align:left;"),$(document.getElementById("PRODUCT_CODE_2_"+o).parentElement).find("button").remove(),closeBoxDraggable(l),AlayiniHesapla()}function AlayiniHesapla(){AktifSepet=[],OrderFooter={total_default:0,genel_indirim_:0,total_discount_wanted:0,brut_total_wanted:0,total_tax_wanted:0,net_total_wanted:0,other_money:"TL"};var e=document.getElementById("BasketArea").children;for(let k=0;k<e.length;k++){var t=e[k],n=t.getAttribute("data-proplist"),a=document.getElementById("AddedEquipment_"+n).value,r=JSON.parse(a),o=document.getElementById("SubSepetBody_"+n),l=0,d=o.children.length;document.getElementById("RC_"+n).innerText=d;var i=0,u=KurGetir(OfferData.OTHER_MONEY);for(let e=0;e<o.children.length;e++){var m=o.children[e];i++;var c=DegeriGetir(m,"PRODUCT_ID",1),_=DegeriGetir(m,"IS_VIRTUAL",1),p=DegeriGetir(m,"PRODUCT_NAME",0),E=DegeriGetir(m,"PRODUCT_CODE_2",0),s=0;0==OfferSettings.IS_TAX_ZERO&&(s=DegeriGetir(m,"TAX",2,0));var T=DegeriGetir(m,"STOCK_ID",1),C=DegeriGetir(m,"QUANTITY",2,1),I=DegeriGetir(m,"PRODUCT_UNIT",0),O=DegeriGetir(m,"PURCHASE_PRICE",2,1),A=DegeriGetir(m,"PURCHASE_MONEY",0),R=DegeriGetir(m,"SALE_PRICE",2,1),g=DegeriGetir(m,"SALE_MONEY",0),D=DegeriGetir(m,"SALE_DISCOUNT",2,1),P=DegeriGetir(m,"UNIQUE_RELATION_ID",0),S=DegeriGetir(m,"SALE_DISCOUNT_MONEY",0,0),b=DegeriGetir(m,"TOTAL_PRICE_MONEY",0,0),v=R-D;DegerYaz(m,"UNIT_PRICE",2,v);var f=0;if(u.MONEY==b)f=v*C;else{var y=MONEY_ARR.findIndex(e=>e.MONEY==b),h=MONEY_ARR[y],N=u.RATE2/h.RATE2;f=v*C*N}var U=R,B=R*u.RATE2;DegerYaz(m,"TOTAL_PRICE",2,f);var M=v*C*u.RATE2,w=M*s/100,x=M+w,L={PRODUCT_ID:c,STOCK_ID:T,PRODUCT_NAME:p,PRODUCT_CODE_2:E,AMOUNT:C,PRICE_OTHER:U,PRICE:B,OTHER_MONEY:OfferData.OTHER_MONEY,OTHER_MONEY_VALUE:f,DISCOUNT_COST:D,TL_TOTAL_PRICE:M,PRODUCT_UNIT:I,PURCHASE_PRICE:O,PURCHASE_MONEY:A,SALE_PRICE:R,SALE_PRICE:R,SALE_MONEY:g,IS_VIRTUAL:_,UNIQUE_RELATION_ID:P,SALE_DISCOUNT:D,PROP_LIST:n,JSON_STRINGIM:r,SALE_DISCOUNT_MONEY:S,UNIT_PRICE:v,TOTAL_PRICE:f,TOTAL_PRICE_MONEY:b,TAX_RATE:s,TAX:w,WITH_TAX:x,RATE2:u.RATE2,SEPET_SIRA:i};if(L.TLF=L.OTHER_MONEY_VALUE*u.RATE2,L.TOTAL_PRICE_MONEY==u.MONEY)l+=L.TOTAL_PRICE;else{var Y=MONEY_ARR.findIndex(e=>e.MONEY==L.TOTAL_PRICE_MONEY),F=MONEY_ARR[Y].RATE2;l+=L.TOTAL_PRICE*F}OrderFooter.total_default+=L.PRICE_OTHER*C,OrderFooter.total_discount_wanted+=L.PRICE_OTHER*L.AMOUNT-L.UNIT_PRICE*L.AMOUNT,AktifSepet.push(L)}document.getElementById("TOTALE_"+n).innerText=commaSplit(l),OrderFooter.TOTAL_PRICE+=l}var k=document.getElementById("genel_indirim_").value;k.length>0?(k=filterNum(commaSplit(k)),k=parseFloat(k),document.getElementById("genel_indirim_").value=commaSplit(k),OrderFooter.genel_indirim_=k):(document.getElementById("genel_indirim_").value=commaSplit(0),k=0,OrderFooter.genel_indirim_=k),OrderFooter.total_discount_wanted+=k,OrderFooter.brut_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted,OrderFooter.total_tax_wanted=0,OrderFooter.net_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted+OrderFooter.total_tax_wanted,OzetOlustur()}function GenerateUniqueId(){var e=new Date,t=e.toISOString().split("T")[0],n=e.toISOString().split("T")[1],a=t.replaceAll("-",""),r=n.replaceAll(":","");r=r.replaceAll(".",""),console.log(r);var o="PBS"+generalParamsSatis.userData.user_id+a+r;return o}function DegeriGetir(e,t,n=0,a=0){var r=$(e).find("input[name='"+t+"']").val(),o=0;if(r)0==n?o=r:1==n?o=parseInt(r):2==n&&(o=parseFloat(filterNum(commaSplit(r)))),1==a&&(2!=n&&1!=n||$(e).find("input[name='"+t+"']").val(commaSplit(o)));else{r=$(e).find("select[name='"+t+"']").val();0==n?o=r:1==n?o=parseInt(r):2==n&&(o=parseFloat(filterNum(commaSplit(r))))}return o}function DegerYaz(e,t,n=0,a){var r=$(e).find("input[name='"+t+"']")[0],o=0;r?0==n?o=a:1==n?o=commaSplit(a):2==n&&(o=commaSplit(a)):(r=$(e).find("select[name='"+t+"']")[0],0==n?o=a:1==n?o=parseInt(a):2==n&&(o=parseFloat(filterNum(commaSplit(a))))),$(r).val(o)}function KurGetir(e){var t=MONEY_ARR.findIndex(t=>t.MONEY==e);return MONEY_ARR[t]}function OzetOlustur(){var e="<ul>",t=document.getElementById("BasketArea").children;for(let i=0;i<t.length;i++){var n=t[i],a=$(n).find("table"),r=a[0].children[0].cells;e+="<li><table class='table'><tr><td>";var o=n.getAttribute("data-proplist"),l=document.getElementById("SubSepetBody_"+o);for(let t=0;t<r.length;t++){var d=r[t];try{e+=d.lastChild.innerText+"->"}catch{}}
e+="</td><td> "+l.children.length+"</</td></tr></table></li>"}e+="</ul>",$("#OzetAlani").html(e);var i=KurGetir(OfferData.OTHER_MONEY);$("#brut_total_wanted").val(commaSplit(OrderFooter.brut_total_wanted)),$("#brut_total_wanted_").val(commaSplit(OrderFooter.brut_total_wanted*i.RATE2)),$("#genel_indirim_").val(commaSplit(OrderFooter.genel_indirim_)),$("#genel_indirim__").val(commaSplit(OrderFooter.genel_indirim_*i.RATE2)),$("#net_total_wanted").val(commaSplit(OrderFooter.net_total_wanted)),$("#net_total_wanted_").val(commaSplit(OrderFooter.net_total_wanted*i.RATE2)),$("#total_default").val(commaSplit(OrderFooter.total_default)),$("#total_default_").val(commaSplit(OrderFooter.total_default*i.RATE2)),$("#total_discount_wanted").val(commaSplit(OrderFooter.total_discount_wanted)),$("#total_discount_wanted_").val(commaSplit(OrderFooter.total_discount_wanted*i.RATE2)),$("#total_tax_wanted").val(commaSplit(OrderFooter.total_tax_wanted)),$("#total_tax_wanted_").val(commaSplit(OrderFooter.total_tax_wanted*i.RATE2)),OrderFooter.brut_total_wanted_=OrderFooter.brut_total_wanted*i.RATE2,OrderFooter.genel_indirim__=OrderFooter.genel_indirim_*i.RATE2,OrderFooter.net_total_wanted_=OrderFooter.net_total_wanted*i.RATE2,OrderFooter.total_default_=OrderFooter.total_default*i.RATE2,OrderFooter.total_discount_wanted_=OrderFooter.total_discount_wanted*i.RATE2,OrderFooter.total_tax_wanted_=OrderFooter.total_tax_wanted*i.RATE2}function lookProducts(e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_products_pbs&proplist="+e)}function SaveOffer(){AlayiniHesapla();var e=new Object;e.OFFER_HEADER=OfferData,e.ROWS=AktifSepet,e.OFFER_FOOTER=OrderFooter,$.ajax({url:"/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=SAVE_OFFER_ROWS",data:{data:JSON.stringify(e)},type:"POST",success:function(e){$.notification(["Kayıt Edildi"],{messageType:"error"})}})}function get_consumer(e="",t=""){AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_get_company_partner&KEYWORD="+e.value,"text_cpm_search_result_area",1,"Yükleniyor")}function AddToCons(){var e=document.getElementsByName("comp_sel_cb"),t=document.getElementsByName("CBX");for(let I=0;I<e.length;I++){var n=e[I];if($(n).is(":checked")){var a=SelectedCompArr.findIndex(e=>e.COMPANY_ID==n.value),r=document.getElementById("comp_sel_mb_"+n.value).innerText,o=document.getElementById("comp_sel_nn_"+n.value).innerText;if(-1==a){var l={COMPANY_ID:n.value,NICKNAME:o,MEMBER_CODE:r,IS_PURCHASE_SAVED:0,P_PRICE_COUNT:0,OFFER_ID:0,PIDS:[]};for(let e=0;e<=t.length;e++)try{var d=t[e];if($(d).is(":checked")){var i=document.getElementById("PRODUCT_ID_"+(e+1)).value,u=document.getElementById("STOCK_ID_"+(e+1)).value,m=document.getElementById("PRODUCT_NAME_"+(e+1)).value,c=document.getElementById("PRODUCT_CODE_2_"+(e+1)).value,_=document.getElementById("QUANTITY_"+(e+1)).value,p=document.getElementById("UNIQUE_RELATION_ID_"+(e+1)).value,E=document.getElementById("PRODUCT_UNIT_"+(e+1)).value,s={PID:i,SID:u,QUANTITY:filterNum(_),UNIQUE_RELATION_ID:p,PRODUCT_NAME:m,PRODUCT_CODE_2:c,PRODUCT_UNIT:E,PRICE:0,PRICE_OTHER:0,OTHER_MONEY:""};l.PIDS.push(s)}}catch(e){}SelectedCompArr.push(l)}else for(let e=0;e<=t.length;e++)try{d=t[e];var T="PRODUCT_ID_"+(e+1);console.log(T);i=document.getElementById("PRODUCT_ID_"+(e+1)).value,u=document.getElementById("STOCK_ID_"+(e+1)).value,m=document.getElementById("PRODUCT_NAME_"+(e+1)).value,c=document.getElementById("PRODUCT_CODE_2_"+(e+1)).value,_=document.getElementById("QUANTITY_"+(e+1)).value,p=document.getElementById("UNIQUE_RELATION_ID_"+(e+1)).value,E=document.getElementById("PRODUCT_UNIT_"+(e+1)).value;if($(d).is(":checked")){var C=SelectedCompArr[a].PIDS.findIndex(e=>e.UNIQUE_RELATION_ID==p);if(-1==C){s={PID:i,SID:u,QUANTITY:filterNum(_),UNIQUE_RELATION_ID:p,PRODUCT_NAME:m,PRODUCT_CODE_2:c,PRODUCT_UNIT:E,PRICE:0,PRICE_OTHER:0,OTHER_MONEY:""};SelectedCompArr[a].PIDS.push(s)}}}catch(e){}}}TedarikYaz()}function TedarikYaz(){$("#tedarik").html("");for(let c=0;c<SelectedCompArr.length;c++){var e=SelectedCompArr[c];console.table(e);var t=document.createElement("table");t.setAttribute("class","table table-sm table-stripped"),t.setAttribute("style","border: solid 0.5px #d9d9d9;box-shadow: 1px 2px 20px 0px #cfc7c7;margin-top:5px !important;");var n=document.createElement("tr"),a=document.createElement("th");a.innerText=e.MEMBER_CODE,a.setAttribute("style","color:#fb6b5b;width:10%"),a.setAttribute("onclick","$('#tr_"+e.COMPANY_ID+"').toggle()"),n.appendChild(a);a=document.createElement("th");if(a.innerText=e.NICKNAME,0!=e.OFFER_ID){var r=document.createElement("span");r.setAttribute("class","fa fa-envelope"),r.setAttribute("style","    float: right;margin-right: 10px; padding: 1px 8px 1px 8px;  border-radius: 50%;"),r.setAttribute("onclick","windowopen('/index.cfm?fuseaction=objects.emptypopup_print_pdf_multi&is_sale=0&offer_id="+e.OFFER_ID+"')"),a.appendChild(r)}r=document.createElement("span");r.innerText=e.PIDS.length,r.setAttribute("style","    float: right;margin-right: 10px;  background: #fb6b5b;  color: white;  padding: 1px 8px 1px 8px;  border-radius: 50%;"),a.setAttribute("style","color:#fb6b5b"),a.appendChild(r);r=document.createElement("span");r.innerText=e.P_PRICE_COUNT,r.setAttribute("style","    float: right;margin-right: 10px;  background: #20a30a;  color: white;  padding: 1px 8px 1px 8px;  border-radius: 50%;"),e.PIDS.length==parseInt(e.P_PRICE_COUNT)&&a.setAttribute("style","color:#20a30a"),a.appendChild(r),n.appendChild(a),t.appendChild(n);n=document.createElement("tr"),a=document.createElement("td");a.setAttribute("colspan","2");var o=document.createElement("table");o.setAttribute("class","table table-sm table-stripped");var l=document.createElement("tr"),d=document.createElement("th");d.innerText="Part Number",l.appendChild(d);d=document.createElement("th");d.innerText="Product Name",l.appendChild(d);d=document.createElement("th");d.innerText="Amount",l.appendChild(d);d=document.createElement("th");d.innerText="Offered Prıce",l.appendChild(d);d=document.createElement("th");d.innerText="Money",l.appendChild(d),o.appendChild(l);for(let t=0;t<e.PIDS.length;t++){var i=e.PIDS[t],u=document.createElement("tr"),m=document.createElement("td");m.innerText=i.PRODUCT_CODE_2,u.appendChild(m);m=document.createElement("td");m.innerText=i.PRODUCT_NAME,u.appendChild(m);m=document.createElement("td");m.innerText=i.QUANTITY,u.appendChild(m);m=document.createElement("td");m.innerText=commaSplit(i.PRICE_OTHER),u.appendChild(m);m=document.createElement("td");m.innerText=i.OTHER_MONEY,u.appendChild(m),o.appendChild(u)}a.appendChild(o),n.appendChild(a),n.setAttribute("style","display:none"),n.id="tr_"+e.COMPANY_ID,t.appendChild(n),document.getElementById("tedarik").appendChild(t)}}function AddPurchaseOffer(){var e=getParameterByName("offer_id"),t={OFFER_ID:e,FormData:SelectedCompArr};$.ajax({url:"/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=AddPurchaseOffer",data:{FormData:JSON.stringify(t)},success:function(e){$.notification(["Kayıt Edildi"],{messageType:"error"})}})}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function loadRelOffers(){}function SavePropToShip(){var e=document.getElementById("WESSEL_ID").value;openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+e)}function ShowProperties(e){var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value,a=document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist");openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=ShowProductProperties&rc="+t+"&PID="+n+"&prp_list="+a)}function ShowImages(e){var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value;document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist");openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_show_product_images&PRODUCT_ID="+n)}function ShowImages2(e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_show_product_images&PRODUCT_ID="+e)}function SatinAlmaKontrol(e){var t=[];SelectedCompArr=[],$.get("/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=getPurchaseOfferListForSaleOffer&OFFER_ID="+e).done(function(e){var n=JSON.parse(e);console.log(n);for(let e=0;e<n.length;e++){var a=n[e],r={COMPANY_ID:a.COMPANY_ID,NICKNAME:a.NICKNAME,MEMBER_CODE:a.MEMBER_CODE,IS_PURCHASE_SAVED:1,P_PRICE_COUNT:a.OFFER_ROWS.FIYAT_VERILEN,OFFER_ID:a.OFFER_ID,PIDS:[]};for(let e=0;e<a.OFFER_ROWS.ROWS.length;e++){var o=a.OFFER_ROWS.ROWS[e],l={PID:o.PRODUCT_ID,SID:o.STOCK_ID,QUANTITY:o.QUANTITY,UNIQUE_RELATION_ID:o.UNIQUE_RELATION_ID,PRODUCT_NAME:o.PRODUCT_NAME,PRODUCT_CODE_2:o.MANUFACT_CODE,PRODUCT_UNIT:o.MAIN_UNIT,PRICE:o.PRICE,PRICE_OTHER:o.PRICE_OTHER,OTHER_MONEY:o.OTHER_MONEY};r.PIDS.push(l)}t.push(r),SelectedCompArr.push(r)}console.log(SelectedCompArr),console.log(t),TedarikYaz()})}function open_product_popup(e){url_str="index.cfm?fuseaction=objects.popup_detail_product";var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value,a=document.getElementById("STOCK_ID_"+t).value,r=n,o=a;""!=o&&openBoxDraggable(url_str+"&pid="+o+"&sid="+r)}function CoppyOfferCanim(e,t){$.post(ServiceUri+"/OfferService.cfc?method=CopyOffer&OFFER_ID="+e+"&OFFER_NUMBER="+t).done(function(e){var t=JSON.parse(e);if(1==t.STATUS){var n=confirm("Kopyalama Başarılı Yeni Oluşan Teklife Gidilsinmi");n&&(window.location.href="/index.cfm?fuseaction=sale.emptypopup_hrz_pbs_sayfa3&offer_id="+t.OFFER_ID)}else alert("Bir Hata Oluştu")})}var RowCount=1,ServiceUri="/AddOns/YafSatis/Partner/cfc";$(document).ready(function(){var e=document.getElementById("PRODUCT_CAT");getCats(e),get_consumer("","")});var EqArr=[],AktifSepet=[],OfferSettings={IS_TAX_ZERO:1},OrderFooter={total_default:0,genel_indirim_:0,total_discount_wanted:0,brut_total_wanted:0,total_tax_wanted:0,net_total_wanted:0,other_money:"TL"},SelectedCompArr=[];