function getCats(e){$.ajax({url:ServiceUri+"/ProductService.cfc?method=getCats",success:function(t){var n=JSON.parse(t);$(e).html("");for(let t=0;t<n.length;t++){var a=document.createElement("option");a.value=n[t].PRODUCT_CATID,a.innerText=n[t].PRODUCT_CAT,e.appendChild(a)}}})}function getCatProperties(e){try{$("#BUTOCUMMMMM").remove()}catch{}var t=document.getElementById("WESSEL_ID").value;if(t.length>0)$.post(ServiceUri+"/OfferService.cfc?method=getShipFilters&SHIP_ID="+t+"&PRODUCT_CATID="+e).done(function(n){var a=JSON.parse(n);if(1==a.STATUS){var r=confirm("Bu Gemi'de Bu Ekipmana Bağlı Filtreler Kayıt Edilmiştir Yüklemek İstermisiniz"),o=document.createElement("a");o.setAttribute("class","input-group-addon"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+t+"&cat_id="+e+"')"),o.id="BUTOCUMMMMM";var l=document.createElement("span");l.setAttribute("class","icn-md fa fa-gears"),o.appendChild(l),document.getElementById("PRODUCT_CAT").parentElement.appendChild(o),r?1==a.RECORD_COUNT?(addEqRow(a.JSON_STRINGIM,JSON.stringify(a.JSON_STRINGIM)),AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")):(openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+t+"&cat_id="+e),AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")):AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")}else AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")});else AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=catProps&PRODUCT_CATID="+e,"PROP_AREA",1,"Yükleniyor")}function AddEquipment(){var e=getFilterData(),t=e.ReturnObject;t.SEPERATOR_SIRA=SeperatorSira;var n=e.jsn;addEqRow(t,n,SeperatorSira)}function getFilterData(){var e=document.getElementById("PRODUCT_CAT"),t=e.options.selectedIndex,n=e.options[t].innerText,a=e.options[t].value,r={PRODUCT_CAT:n,PRODUCT_CAT_ID:a},o=[],l={PRODUCT_CAT:n,PRODUCT_CAT_ID:a,PNAME:"EQUIPMENT",PROP_ID:0,IS_OPTIONAL:0};o.push(l);var i=document.getElementsByClassName("propss"),d="";d+=a;var u=0;for(let e=0;e<i.length;e++){var p=i[e],c=p.getAttribute("required"),s=$(p).select2("data")[0],m=s.element.parentElement.getAttribute("data-property_id"),_=s.element.parentElement.getAttribute("data-is_optional");console.log(_);n=s.text,a=s.id;var E=s.title;if(s.id.length>0){var C={PRODUCT_CAT:n,PRODUCT_CAT_ID:a,PNAME:E,PROP_ID:m,IS_OPTIONAL:_};o.push(C),d+=","+a}"true"==c&&0==s.id.length&&u++}r.Filters=o,r.PropList=d;var T=JSON.stringify(r);if(console.log(r),u>0)return alert("Zorunlu Alanlar var !"),!1;var I=new Object;return I.ReturnObject=r,I.jsn=T,I}function addEqRow(e,t,n=""){try{var a=EqArr.findIndex(t=>t==e.PropList);if(-1!=a)return!1;var r=document.createElement("div");r.setAttribute("class","alert alert-success eq_header"),r.setAttribute("style","position:relative"),r.setAttribute("data-PropList",e.PropList),n.length>0?(r.setAttribute("data-SeperatorSira",n),SeperatorSira++):(r.setAttribute("data-SeperatorSira",SeperatorSira),SeperatorSira++);var o=document.createElement("table");o.setAttribute("class","EqTableMain");var l=document.createElement("tr"),i=document.createElement("td"),d=document.createElement("button");d.setAttribute("class","ui-wrk-btn");var u='<span class="icn-md icon-down"></span>';d.innerHTML=u,d.setAttribute("onclick","$('#SLO_'"+e.PropList+").toggle()");var p=document.createElement("button");p.setAttribute("onclick","SepearatorSec(this)"),p.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra");u='<span class="icn-md fa fa-check-square-o"></span>';p.innerHTML=u;var c=document.createElement("button");c.setAttribute("class","ui-wrk-btn ui-wrk-btn-success");u='<span class="icn-md fa fa-plus"></span>';c.innerHTML=u,c.setAttribute("onclick","addRowCrs('"+e.PropList+"')");var s=document.createElement("button");s.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning");u='<span class="icn-md fa fa-edit"></span>';s.innerHTML=u;var m=document.createElement("button");m.setAttribute("class","ui-wrk-btn ui-wrk-btn-red");u='<span class="icn-md icon-remove"></span>';m.setAttribute("onclick","SeciliSil('"+e.PropList+"')"),m.innerHTML=u;var _=document.createElement("button");_.setAttribute("class","ui-wrk-btn "),_.setAttribute("style","background:#292424 !important;color:white"),_.setAttribute("onclick","SeperatorSil('"+e.PropList+"')"),_.innerHTML='<span class="icn-md fa fa-trash"></span>';var E=document.createElement("button");E.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),E.innerHTML='<span class="icn-md icon-filter"></span>',E.setAttribute("onclick","lookProducts('"+e.PropList+"')");var C=document.createElement("div");C.setAttribute("style","display:flex"),p.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),c.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),s.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),m.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),_.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),E.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),C.appendChild(p),C.appendChild(c),C.appendChild(s),C.appendChild(m),C.appendChild(_),C.appendChild(E),i.appendChild(C);var T=document.createElement("input");T.id="SeperatorRC_"+e.PropList,T.name="SeperatorRC_"+e.PropList,T.type="hidden",T.value=1,i.appendChild(T),l.appendChild(i);var I=8;for(let t=0;t<e.Filters.length;t++){const n=e.Filters[t];i=document.createElement("td");i.setAttribute("style","border-right:solid 1px;width:"+I+"%");var A="<span style='font-weight:bold'>"+n.PNAME+"</span></br><span>"+n.PRODUCT_CAT+"</span>";i.innerHTML=A,l.appendChild(i)}var O=0,R=0;if(e.Filters.length<12){O=12-e.Filters.length,R=8*O;i=document.createElement("td");i.setAttribute("style","width:"+R+"%"),l.appendChild(i)}o.appendChild(l);T=document.createElement("input");T.setAttribute("type","hidden"),T.value=t,T.name="AddedEquipment",T.id="AddedEquipment_"+e.PropList,r.appendChild(T),r.appendChild(o);var g=document.createElement("div");g.setAttribute("style","background:white"),g.setAttribute("id","SLO_"+e.PropList);var b=document.createElement("table");b.setAttribute("class","SubSepet table");var S=document.createElement("thead");l=document.createElement("tr");l.appendChild(thCrate("#")),l.appendChild(thCrate("Part No")),l.appendChild(thCrate("Part Name")),l.appendChild(thCrate("Quantity")),l.appendChild(thCrate("Unit")),l.appendChild(thCrate("Purchase Price")),l.appendChild(thCrate("Sales Price")),l.appendChild(thCrate("Sales Discount")),l.appendChild(thCrate("Unit Price")),l.appendChild(thCrate("Total Price")),l.appendChild(thCrate("First Remark")),l.appendChild(thCrate("Total Stock")),l.appendChild(thCrate("Weight")),S.appendChild(l),b.appendChild(S),b.id="SubSepet_"+e.PropList;var h=document.createElement("tbody");h.id="SubSepetBody_"+e.PropList,b.appendChild(h),g.appendChild(b),r.appendChild(g);var P='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";P='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PropList+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PropList+'">0 '+OfferData.OTHER_MONEY+"</span></button>";P=$(P)[0],r.appendChild(P),document.getElementById("BasketArea").appendChild(r),EqArr.push(e.PropList)}catch{addEqRow_01(e,t)}}function addEqRow_01(e,t,n=""){var a=EqArr.findIndex(t=>t==e.PROPLIST);if(-1!=a)return!1;var r=document.createElement("div");r.setAttribute("class","alert alert-success eq_header"),r.setAttribute("style","position:relative"),r.setAttribute("data-PropList",e.PROPLIST),n.length>0?(r.setAttribute("data-SeperatorSira",n),SeperatorSira++):(r.setAttribute("data-SeperatorSira",SeperatorSira),SeperatorSira++);var o=document.createElement("table");o.setAttribute("class","EqTableMain");var l=document.createElement("tr"),i=document.createElement("td"),d=document.createElement("button");d.setAttribute("class","ui-wrk-btn");var u='<span class="icn-md icon-down"></span>';d.innerHTML=u,d.setAttribute("onclick","$('#SLO_'"+e.PROPLIST+").toggle()");var p=document.createElement("button");p.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),p.setAttribute("onclick","SepearatorSec(this)");u='<span class="icn-md fa fa-check-square-o"></span>';p.innerHTML=u;var c=document.createElement("button");c.setAttribute("class","ui-wrk-btn ui-wrk-btn-success");u='<span class="icn-md fa fa-plus"></span>';c.innerHTML=u,c.setAttribute("onclick","addRowCrs('"+e.PROPLIST+"')");var s=document.createElement("button");s.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning");u='<span class="icn-md fa fa-edit"></span>';s.innerHTML=u;var m=document.createElement("button");m.setAttribute("class","ui-wrk-btn ui-wrk-btn-red");u='<span class="icn-md icon-remove"></span>';m.setAttribute("onclick","SeciliSil('"+e.PROPLIST+"')"),m.innerHTML=u;var _=document.createElement("button");_.setAttribute("class","ui-wrk-btn "),_.setAttribute("style","background:#292424 !important;color:white"),_.setAttribute("onclick","SeperatorSil('"+e.PROPLIST+"')"),_.innerHTML='<span class="icn-md fa fa-trash"></span>';var E=document.createElement("button");E.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),E.innerHTML='<span class="icn-md icon-filter"></span>',E.setAttribute("onclick","lookProducts('"+e.PROPLIST+"')");var C=document.createElement("div");C.setAttribute("style","display:flex"),p.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),c.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),s.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),m.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),_.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),E.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),C.appendChild(p),C.appendChild(c),C.appendChild(s),C.appendChild(m),C.appendChild(_),C.appendChild(E),i.appendChild(C);var T=document.createElement("input");T.id="SeperatorRC_"+e.PROPLIST,T.name="SeperatorRC_"+e.PROPLIST,T.type="hidden",T.value=1,i.appendChild(T),l.appendChild(i);var I=8;for(let t=0;t<e.FILTERS.length;t++){const n=e.FILTERS[t];i=document.createElement("td");i.setAttribute("style","border-right:solid 1px;width:"+I+"%");var A="<span style='font-weight:bold'>"+n.PNAME+"</span></br><span>"+n.PRODUCT_CAT+"</span>";i.innerHTML=A,l.appendChild(i)}var O=0,R=0;if(e.FILTERS.length<12){O=12-e.FILTERS.length,R=8*O;i=document.createElement("td");i.setAttribute("style","width:"+R+"%"),l.appendChild(i)}o.appendChild(l);T=document.createElement("input");T.setAttribute("type","hidden"),T.value=t,T.name="AddedEquipment",T.id="AddedEquipment_"+e.PROPLIST,r.appendChild(T),r.appendChild(o);var g=document.createElement("div");g.setAttribute("style","background:white"),g.setAttribute("id","SLO_"+e.PROPLIST);var b=document.createElement("table");b.setAttribute("class","SubSepet table");var S=document.createElement("thead");l=document.createElement("tr");l.appendChild(thCrate("#")),l.appendChild(thCrate("Part No")),l.appendChild(thCrate("Part Name")),l.appendChild(thCrate("Quantity")),l.appendChild(thCrate("Unit")),l.appendChild(thCrate("Purchase Price")),l.appendChild(thCrate("Sales Price")),l.appendChild(thCrate("Sales Discount")),l.appendChild(thCrate("Unit Price")),l.appendChild(thCrate("Total Price")),l.appendChild(thCrate("First Remark")),l.appendChild(thCrate("Total Stock")),l.appendChild(thCrate("Weight")),S.appendChild(l),b.appendChild(S),b.id="SubSepet_"+e.PROPLIST;var h=document.createElement("tbody");h.id="SubSepetBody_"+e.PROPLIST,b.appendChild(h),g.appendChild(b),r.appendChild(g);var P='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PROPLIST+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PROPLIST+'">0 '+OfferData.OTHER_MONEY+"</span></button>";P='<button class="ui-wrk-btn ui-wrk-btn-extra" style="position: absolute;right: 0;top: 0;"><span id="RC_'+e.PROPLIST+'">0</span> Rows Listed<br><span id="TOTALE_'+e.PROPLIST+'">0 '+OfferData.OTHER_MONEY+"</span></button>";P=$(P)[0],r.appendChild(P),document.getElementById("BasketArea").appendChild(r),EqArr.push(e.PROPLIST)}function addRowCrs(e,t="",n="",a="",r,o="",l=1,i="",d=0,u="",p=0,c=0,s=0,m=0,_="",E=0,C=0,T=0,I="",A=0){$("#SLO_"+e).show();var O=document.createElement("tr"),R=document.createElement("td"),g=document.createElement("input");g.type="checkbox",g.name="CBX",g.id="CBX_"+RowCount,g.setAttribute("class","SatirSecCbx");var b=document.createElement("input");b.type="hidden",b.name="IS_VIRTUAL",b.id="IS_VIRTUAL_"+RowCount,b.value=T;var S=document.createElement("input");S.type="hidden",S.name="UNIQUE_RELATION_ID",S.id="UNIQUE_RELATION_ID_"+RowCount,I.length>0?S.value=I:S.value=GenerateUniqueId();var h=document.createElement("button");h.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning"),h.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;"),h.innerText=RowCount;var P=document.createElement("button");P.setAttribute("class","ui-wrk-btn ui-wrk-btn-success"),P.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");var f=document.createElement("button");f.setAttribute("class","ui-wrk-btn ui-wrk-btn-extra"),f.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");var D=document.createElement("span");D.setAttribute("class","icn-md fa fa-info"),f.appendChild(D);var v=document.createElement("button");v.setAttribute("class","ui-wrk-btn ui-wrk-btn-busy"),v.setAttribute("id","ResimButonC_"+RowCount),v.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");D=document.createElement("span");D.setAttribute("class","icn-md fa fa-camera"),v.appendChild(D);var y=document.createElement("button");y.setAttribute("class","ui-wrk-btn ui-wrk-btn-warning"),y.setAttribute("style","font-size: 7px !important;padding: 3px 7px !important;");D=document.createElement("span");D.setAttribute("class","icn-md fa fa-dashboard"),y.appendChild(D);var N=document.getElementById("SeperatorRC_"+e).value;N=parseInt(N),P.innerText=N,P.setAttribute("onclick","MoveRow("+N+")"),f.setAttribute("onclick","ShowProperties(this)"),f.setAttribute("data-rc",RowCount),v.setAttribute("onclick","ShowImages(this)"),v.setAttribute("data-rc",RowCount),y.setAttribute("onclick","open_product_popup(this)"),y.setAttribute("data-rc",RowCount);var U=document.createElement("div");U.setAttribute("style","display:flex"),U.appendChild(g),U.appendChild(b),U.appendChild(S),U.appendChild(h),U.appendChild(P),U.appendChild(f),U.appendChild(v),U.appendChild(y),N++,R.appendChild(U),O.appendChild(R),document.getElementById("SeperatorRC_"+e).value=N;R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");g=document.createElement("input");if(g.setAttribute("type","text"),g.name="PRODUCT_CODE_2",g.value=o,g.id="PRODUCT_CODE_2_"+RowCount,g.setAttribute("proplist",e),1==T?g.setAttribute("style","color:black;font-weight:bold;text-align:left;background:yellow;"):g.setAttribute("style","text-align:left"),g.setAttribute("onchange","getProduct(this,"+RowCount+")"),U.appendChild(g),1==A){g.setAttribute("style","color:orange;font-weight:bold;text-align:left;");var w=document.createElement("button");w.setAttribute("class","btn btn-warning"),w.innerHTML="<i class='icn-md fa fa-search'></i>",U.appendChild(w),U.setAttribute("style","display:flex"),w.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=getCollation&rc="+RowCount+"&kw="+g.value+"&prp_list="+e+"')")}g=document.createElement("input");g.type="hidden",g.name="PRODUCT_ID",g.id="PRODUCT_ID_"+RowCount,g.value=t,U.appendChild(g);g=document.createElement("input");g.type="hidden",g.name="STOCK_ID",g.id="STOCK_ID_"+RowCount,g.value=n,U.appendChild(g);g=document.createElement("input");g.type="hidden",g.name="TAX",g.value=r,g.id="TAX_"+RowCount,U.appendChild(g),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");g=document.createElement("input");g.setAttribute("type","text"),g.name="PRODUCT_NAME",g.value=a,g.id="PRODUCT_NAME_"+RowCount,g.setAttribute("style","text-align:left"),U.appendChild(g),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");g=document.createElement("input");g.setAttribute("type","text"),g.name="QUANTITY",g.id="QUANTITY_"+RowCount,g.value=commaSplit(l),g.setAttribute("onchange","AlayiniHesapla()"),U.appendChild(g),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");g=document.createElement("select");var L=document.createElement("option");L.value=i,L.innerText=i,g.name="PRODUCT_UNIT",g.id="PRODUCT_UNIT_"+RowCount,g.appendChild(L),U.appendChild(g),R.appendChild(U),O.appendChild(R),I.length;R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");var x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.setAttribute("readonly","yes"),g.name="PURCHASE_PRICE",g.id="PURCHASE_PRICE_"+RowCount,0!=d&&g.setAttribute("style","color:green"),g.value=commaSplit(d),x.appendChild(g);g=document.createElement("select");0==u.length&&(u=OfferData.OTHER_MONEY),g.innerHTML=CreateOptionList(1,u),g.name="PURCHASE_MONEY",g.id="PURCHASE_MONEY_"+RowCount,g.setAttribute("class","input-group-text"),g.setAttribute("disabled","disabled"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="SALE_PRICE",g.id="SALE_PRICE_"+RowCount,g.value=commaSplit(p),g.setAttribute("onchange","AlayiniHesapla()"),x.appendChild(g);g=document.createElement("select");g.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),g.name="SALE_MONEY",g.id="SALE_MONEY_"+RowCount,g.setAttribute("disabled","yes"),g.setAttribute("class","input-group-text"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="SALE_DISCOUNT",g.id="SALE_DISCOUNT_"+RowCount,g.value=commaSplit(c),g.setAttribute("onchange","AlayiniHesapla()"),x.appendChild(g);g=document.createElement("select");g.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),g.name="SALE_DISCOUNT_MONEY",g.setAttribute("disabled","yes"),g.id="SALE_DISCOUNT_MONEY_"+RowCount,g.setAttribute("class","input-group-text"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="UNIT_PRICE",g.id="UNIT_PRICE_"+RowCount,g.value=commaSplit(s),g.setAttribute("readonly","yes"),x.appendChild(g);g=document.createElement("select");g.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),g.name="UNIT_PRICE_MONEY",g.id="UNIT_PRICE_MONEY_"+RowCount,g.setAttribute("class","input-group-text"),g.setAttribute("disabled","yes"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="TOTAL_PRICE",g.id="TOTAL_PRICE_"+RowCount,g.setAttribute("readonly","yes"),g.value=commaSplit(m),x.appendChild(g);g=document.createElement("select");g.innerHTML=CreateOptionList(1,OfferData.OTHER_MONEY),g.name="TOTAL_PRICE_MONEY",g.id="TOTAL_PRICE_MONEY_"+RowCount,g.setAttribute("disabled","yes"),g.setAttribute("class","input-group-text"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="FIRST_REMARK",g.value=_,g.id="FIRST_REMARK_"+RowCount,x.appendChild(g);g=document.createElement("span");g.setAttribute("class","input-group-addon btnPointer icon-remove"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="DELIVERED_ITEMS",g.id="DELIVERED_ITEMS_"+RowCount;var B=wrk_safe_query("GETDEPOBAKIYE","DSN2",1,n);B.recordcount>0&&(g.value=commaSplit(B.BAKIYE[0])),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R);R=document.createElement("td"),U=document.createElement("div");U.setAttribute("class","form-group");x=document.createElement("div");x.setAttribute("class","input-group"),x.setAttribute("style","display:flex");g=document.createElement("input");g.setAttribute("type","text"),g.name="WEIGHT",g.id="WEIGHT_"+RowCount,g.value=commaSplit(C),x.appendChild(g);g=document.createElement("select");g.innerHTML="",g.name="WEIGHT_UNIT",g.id="WEIGHT_UNIT_"+RowCount,g.setAttribute("class","input-group-text"),x.appendChild(g),U.appendChild(x),R.appendChild(U),O.appendChild(R),document.getElementById("SubSepetBody_"+e).appendChild(O),RowCount++}function thCrate(e){var t=document.createElement("th");return t.innerText=e,t.setAttribute("class","tablesorter-header tablesorter-headerUnSorted"),t}function getProduct(e,t){var n=e.value,a=document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist"),r=document.getElementById("AddedEquipment_"+a).value;r=JSON.parse(r);var o={SearchMainValue:r,keyword:n};$.ajax({url:ServiceUri+"/ProductService.cfc?method=SearchProduct",data:{FormData:JSON.stringify(o)},success:function(n){var r=JSON.parse(n);if(console.log(r),r.RECORD_COUNT>=1){if(r.RECORD_COUNT>1){e.setAttribute("style","color:orange;font-weight:bold;text-align:left;");var o=document.createElement("button");o.setAttribute("class","btn btn-warning"),o.innerHTML="<i class='icn-md fa fa-search'></i>",e.parentElement.appendChild(o),e.parentElement.setAttribute("style","display:flex"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=getCollation&rc="+t+"&kw="+e.value+"&prp_list="+a+"')")}else if(r.EXTRA_PROPT>0){e.setAttribute("style","color:black;font-weight:bold;text-align:left;background:#7ef1ff");o=document.createElement("button");o.setAttribute("class","btn btn-success"),o.innerHTML="<i class='icn-md fa fa-search'></i>",e.parentElement.appendChild(o),e.parentElement.setAttribute("style","display:flex"),o.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=ShowProductProperties&rc="+t+"&PID="+r.PRODUCT_ID+"&prp_list="+a+"')")}else e.setAttribute("style","color:green;font-weight:bold;text-align:left;");document.getElementById("PRODUCT_NAME_"+t).value=r.PRODUCT_NAME,r.IMG_COUNT>0&&document.getElementById("ResimButonC_"+t).setAttribute("class","ui-wrk-btn ui-wrk-btn-red"),document.getElementById("PRODUCT_ID_"+t).value=r.PRODUCT_ID,document.getElementById("IS_VIRTUAL_"+t).value=r.IS_VIRTUAL,document.getElementById("STOCK_ID_"+t).value=r.STOCK_ID,document.getElementById("TAX_"+t).value=r.TAX,document.getElementById("QUANTITY_"+t).value=commaSplit(1),document.getElementById("PRODUCT_UNIT_"+t).innerHTML='<option value="'+r.MAIN_UNIT+'">'+r.MAIN_UNIT+"</option>",document.getElementById("PURCHASE_PRICE_"+t).value=commaSplit(0),document.getElementById("SALE_PRICE_"+t).value=commaSplit(0),document.getElementById("SALE_DISCOUNT_"+t).value=commaSplit(0),document.getElementById("UNIT_PRICE_"+t).value=commaSplit(0),document.getElementById("TOTAL_PRICE_"+t).value=commaSplit(0);var l=wrk_safe_query("GETDEPOBAKIYE","DSN2",1,r.STOCK_ID);l.recordcount>0&&(document.getElementById("DELIVERED_ITEMS_"+t).value=commaSplit(l.BAKIYE[0]))}else{document.getElementById("IS_VIRTUAL_"+t).value=1,document.getElementById("PRODUCT_ID_"+t).value=0,document.getElementById("STOCK_ID_"+t).value=0;var i=wrk_safe_query("getAllUnits","dsn");for(let e=0;e<i.recordcount;e++){var d=document.createElement("option");d.value=i.UNIT[e],d.innerText=i.UNIT[e],document.getElementById("PRODUCT_UNIT_"+t).appendChild(d)}e.setAttribute("style","color:black;background:yellow;font-weight:bold;text-align:left;")}}})}function MoveRow(e){var t=prompt("To Row"),n=document.getElementById("STOCK_ID_"+e).value,a=document.getElementById("STOCK_ID_"+t).value,r=document.getElementById("PRODUCT_ID_"+e).value,o=document.getElementById("PRODUCT_ID_"+t).value,l=document.getElementById("PRODUCT_CODE_2_"+e).value,i=document.getElementById("PRODUCT_CODE_2_"+t).value,d=document.getElementById("TAX_"+e).value,u=document.getElementById("TAX_"+t).value,p=document.getElementById("PRODUCT_NAME_"+e).value,c=document.getElementById("PRODUCT_NAME_"+t).value,s=document.getElementById("QUANTITY_"+e).value,m=document.getElementById("QUANTITY_"+t).value,_=document.getElementById("PRODUCT_UNIT_"+e).value,E=document.getElementById("PRODUCT_UNIT_"+t).value,C=document.getElementById("PURCHASE_PRICE_"+e).value,T=document.getElementById("PURCHASE_PRICE_"+t).value,I=document.getElementById("PURCHASE_MONEY_"+e).value,A=document.getElementById("PURCHASE_MONEY_"+t).value,O=document.getElementById("SALE_PRICE_"+e).value,R=document.getElementById("SALE_PRICE_"+t).value,g=document.getElementById("SALE_MONEY_"+e).value,b=document.getElementById("SALE_MONEY_"+t).value,S=document.getElementById("SALE_DISCOUNT_"+e).value,h=document.getElementById("SALE_DISCOUNT_"+t).value,P=document.getElementById("SALE_DISCOUNT_MONEY_"+e).value,f=document.getElementById("SALE_DISCOUNT_MONEY_"+t).value,D=document.getElementById("UNIT_PRICE_"+e).value,v=document.getElementById("UNIT_PRICE_"+t).value,y=document.getElementById("UNIT_PRICE_MONEY_"+e).value,N=document.getElementById("UNIT_PRICE_MONEY_"+t).value,U=document.getElementById("TOTAL_PRICE_"+e).value,w=document.getElementById("TOTAL_PRICE_"+t).value,L=document.getElementById("TOTAL_PRICE_MONEY_"+e).value,x=document.getElementById("TOTAL_PRICE_MONEY_"+t).value,B=document.getElementById("FIRST_REMARK_"+e).value,M=document.getElementById("FIRST_REMARK_"+t).value,Y={FromRowData:{ROW_ID:e,STOCK_ID:n,PRODUCT_ID:r,PRODUCT_CODE:l,TAX:d,PRODUCT_NAME:p,QUANTITY:s,UNIT:_,PURCHASE_PRICE:C,PURCHASE_MONEY:I,SALE_PRICE:O,SALE_MONEY:g,SALE_DISCOUNT:S,SALE_DISCOUNT_MONEY:P,UNIT_PRICE:D,UNIT_PRICE_MONEY:y,TOTAL_PRICE:U,TOTAL_PRICE_MONEY:L,FIRST_REMARK:B},ToRowData:{ROW_ID:t,STOCK_ID:a,PRODUCT_ID:o,PRODUCT_CODE:i,TAX:u,PRODUCT_NAME:c,QUANTITY:m,UNIT:E,PURCHASE_PRICE:T,PURCHASE_MONEY:A,SALE_PRICE:R,SALE_MONEY:b,SALE_DISCOUNT:h,SALE_DISCOUNT_MONEY:f,UNIT_PRICE:v,UNIT_PRICE_MONEY:N,TOTAL_PRICE:w,TOTAL_PRICE_MONEY:x,FIRST_REMARK:M}};document.getElementById("STOCK_ID_"+e).value=Y.ToRowData.STOCK_ID,document.getElementById("STOCK_ID_"+t).value=Y.FromRowData.STOCK_ID,document.getElementById("PRODUCT_ID_"+e).value=Y.ToRowData.PRODUCT_ID,document.getElementById("PRODUCT_ID_"+t).value=Y.FromRowData.PRODUCT_ID,document.getElementById("PRODUCT_CODE_2_"+e).value=Y.ToRowData.PRODUCT_CODE,document.getElementById("PRODUCT_CODE_2_"+t).value=Y.FromRowData.PRODUCT_CODE,document.getElementById("TAX_"+e).value=Y.ToRowData.TAX,document.getElementById("TAX_"+t).value=Y.FromRowData.TAX,document.getElementById("PRODUCT_NAME_"+e).value=Y.ToRowData.PRODUCT_NAME,document.getElementById("PRODUCT_NAME_"+t).value=Y.FromRowData.PRODUCT_NAME,document.getElementById("QUANTITY_"+e).value=Y.ToRowData.QUANTITY,document.getElementById("QUANTITY_"+t).value=Y.FromRowData.QUANTITY,document.getElementById("PRODUCT_UNIT_"+e).value=Y.ToRowData.UNIT,document.getElementById("PRODUCT_UNIT_"+t).value=Y.FromRowData.UNIT,document.getElementById("PURCHASE_PRICE_"+e).value=Y.ToRowData.PURCHASE_PRICE,document.getElementById("PURCHASE_PRICE_"+t).value=Y.FromRowData.PURCHASE_PRICE,document.getElementById("PURCHASE_MONEY_"+e).value=Y.ToRowData.PURCHASE_MONEY,document.getElementById("PURCHASE_MONEY_"+t).value=Y.FromRowData.PURCHASE_MONEY,document.getElementById("SALE_PRICE_"+e).value=Y.ToRowData.SALE_PRICE,document.getElementById("SALE_PRICE_"+t).value=Y.FromRowData.SALE_PRICE,document.getElementById("SALE_MONEY_"+e).value=Y.ToRowData.SALE_MONEY,document.getElementById("SALE_MONEY_"+t).value=Y.FromRowData.SALE_MONEY,document.getElementById("SALE_DISCOUNT_"+e).value=Y.ToRowData.SALE_DISCOUNT,document.getElementById("SALE_DISCOUNT_"+t).value=Y.FromRowData.SALE_DISCOUNT,document.getElementById("SALE_DISCOUNT_MONEY_"+e).value=Y.ToRowData.SALE_DISCOUNT_MONEY,document.getElementById("SALE_DISCOUNT_MONEY_"+t).value=Y.FromRowData.SALE_DISCOUNT_MONEY,document.getElementById("UNIT_PRICE_"+e).value=Y.ToRowData.UNIT_PRICE,document.getElementById("UNIT_PRICE_"+t).value=Y.FromRowData.UNIT_PRICE,document.getElementById("UNIT_PRICE_MONEY_"+e).value=Y.ToRowData.UNIT_PRICE_MONEY,document.getElementById("UNIT_PRICE_MONEY_"+t).value=Y.FromRowData.UNIT_PRICE_MONEY,document.getElementById("TOTAL_PRICE_"+e).value=Y.ToRowData.TOTAL_PRICE,document.getElementById("TOTAL_PRICE_"+t).value=Y.FromRowData.TOTAL_PRICE,document.getElementById("TOTAL_PRICE_MONEY_"+e).value=Y.ToRowData.TOTAL_PRICE_MONEY,document.getElementById("TOTAL_PRICE_MONEY_"+t).value=Y.FromRowData.TOTAL_PRICE_MONEY,document.getElementById("FIRST_REMARK_"+e).value=Y.ToRowData.FIRST_REMARK,document.getElementById("FIRST_REMARK_"+t).value=Y.FromRowData.FIRST_REMARK,AlayiniHesapla()}function SeperatorSil(e="7,50014,50015"){var t=document.getElementById("BasketArea"),n=t.children;for(let t=0;t<n.length;t++){var a=n[t],r=a.getAttribute("data-proplist");r==e&&a.remove()}TumSatirlariDuzenle(),AlayiniHesapla()}function TumSatirlariDuzenle(){var e=1,t=document.getElementById("BasketArea"),n=t.children;for(let t=0;t<n.length;t++){var a=n[t],r=a.getAttribute("data-proplist"),o=document.getElementById("SubSepetBody_"+r).children;for(let t=0;t<o.length;t++){var l=o[t],i=l.getElementsByTagName("input"),d=l.getElementsByTagName("select"),u=l.getElementsByTagName("button");for(let t=0;t<i.length;t++){var p=i[t];p.id=p.name+"_"+e}for(let t=0;t<d.length;t++){p=d[t];p.id=p.name+"_"+e}for(let t=0;t<u.length;t++){p=u[t];var c=p.getAttribute("onclick");c||(p.innerText=e)}e++}}RowCount=e}function SeciliSil(e="7,50014,50015"){var t=document.getElementById("SubSepetBody_"+e).children;for(let e=0;e<t.length;e++){var n=t[e],a=$(n).find("input[type='checkbox']")[0]
;$(a).is(":checked")&&($(n).addClass("Silinecek"),console.log(n))}$(".Silinecek").remove();var r=0;t=document.getElementById("SubSepetBody_"+e).children;for(let e=0;e<t.length;e++){r++;var o=t[e],l=o.getElementsByTagName("button");console.log(l);for(let e=0;e<l.length;e++){var i=l[e],d=i.getAttribute("onclick");d&&(console.log("BTNATT="+d),i.innerText=r)}}0==r&&(r=1),document.getElementById("SeperatorRC_"+e).value=r,TumSatirlariDuzenle(),AlayiniHesapla()}function CreateOptionList(e,t="EUR"){if(1==e){var n=paraBirimleri.MONEY,a="";for(let e=0;e<n.length;e++){const r=n[e];a+=t==r?"<option  selected value='"+r+"'>"+r+"</option>":"<option  value='"+r+"'>"+r+"</option>"}$("ReturnStr");return a}}function UpdateRow(e,t,n,a,r,o,l){document.getElementById("PRODUCT_ID_"+o).value=e,document.getElementById("TAX_"+o).value=n,document.getElementById("STOCK_ID_"+o).value=t,document.getElementById("PRODUCT_CODE_2_"+o).value=a,document.getElementById("PRODUCT_NAME_"+o).value=r,document.getElementById("PRODUCT_CODE_2_"+o).setAttribute("style","color:green;font-weight:bold;text-align:left;"),$(document.getElementById("PRODUCT_CODE_2_"+o).parentElement).find("button").remove(),closeBoxDraggable(l),AlayiniHesapla()}function AlayiniHesapla(){AktifSepet=[],OrderFooter={total_default:0,genel_indirim_:0,total_discount_wanted:0,brut_total_wanted:0,total_tax_wanted:0,net_total_wanted:0,other_money:"TL"};var e=document.getElementById("BasketArea").children;for(let H=0;H<e.length;H++){var t=e[H],n=t.getAttribute("data-proplist"),a=t.getAttribute("data-seperatorsira"),r=document.getElementById("AddedEquipment_"+n).value,o=JSON.parse(r),l=document.getElementById("SubSepetBody_"+n),i=0,d=l.children.length;document.getElementById("RC_"+n).innerText=d;var u=0,p=KurGetir(OfferData.OTHER_MONEY);for(let e=0;e<l.children.length;e++){var c=l.children[e];console.log(c),u++;var s=DegeriGetir(c,"PRODUCT_ID",1),m=DegeriGetir(c,"IS_VIRTUAL",1),_=DegeriGetir(c,"PRODUCT_NAME",0),E=DegeriGetir(c,"PRODUCT_CODE_2",0),C=0;0==OfferSettings.IS_TAX_ZERO&&(C=DegeriGetir(c,"TAX",2,0));var T=DegeriGetir(c,"STOCK_ID",1),I=DegeriGetir(c,"QUANTITY",2,1),A=DegeriGetir(c,"PRODUCT_UNIT",0),O=DegeriGetir(c,"PURCHASE_PRICE",2,1),R=DegeriGetir(c,"PURCHASE_MONEY",0),g=DegeriGetir(c,"SALE_PRICE",2,1),b=DegeriGetir(c,"SALE_MONEY",0),S=DegeriGetir(c,"SALE_DISCOUNT",2,1),h=DegeriGetir(c,"UNIQUE_RELATION_ID",0),P=DegeriGetir(c,"SALE_DISCOUNT_MONEY",0,0),f=DegeriGetir(c,"TOTAL_PRICE_MONEY",0,0),D=g-S;DegerYaz(c,"UNIT_PRICE",2,D);var v=0;if(p.MONEY==f)v=D*I;else{var y=MONEY_ARR.findIndex(e=>e.MONEY==f),N=MONEY_ARR[y],U=p.RATE2/N.RATE2;v=D*I*U}var w=g,L=g*p.RATE2;DegerYaz(c,"TOTAL_PRICE",2,v);var x=D*I*p.RATE2,B=x*C/100,M=x+B,Y={PRODUCT_ID:s,STOCK_ID:T,PRODUCT_NAME:_,PRODUCT_CODE_2:E,AMOUNT:I,PRICE_OTHER:w,PRICE:L,OTHER_MONEY:OfferData.OTHER_MONEY,OTHER_MONEY_VALUE:v,DISCOUNT_COST:S,TL_TOTAL_PRICE:x,PRODUCT_UNIT:A,PURCHASE_PRICE:O,PURCHASE_MONEY:R,SALE_PRICE:g,SALE_PRICE:g,SALE_MONEY:b,IS_VIRTUAL:m,UNIQUE_RELATION_ID:h,SALE_DISCOUNT:S,PROP_LIST:n,SEPERATOR_SIRASI:a,JSON_STRINGIM:o,SALE_DISCOUNT_MONEY:P,UNIT_PRICE:D,TOTAL_PRICE:v,TOTAL_PRICE_MONEY:f,TAX_RATE:C,TAX:B,WITH_TAX:M,RATE2:p.RATE2,SEPET_SIRA:u};if(Y.TLF=Y.OTHER_MONEY_VALUE*p.RATE2,Y.TOTAL_PRICE_MONEY==p.MONEY)i+=Y.TOTAL_PRICE;else{var k=MONEY_ARR.findIndex(e=>e.MONEY==Y.TOTAL_PRICE_MONEY),F=MONEY_ARR[k].RATE2;i+=Y.TOTAL_PRICE*F}OrderFooter.total_default+=Y.PRICE_OTHER*I,OrderFooter.total_discount_wanted+=Y.PRICE_OTHER*Y.AMOUNT-Y.UNIT_PRICE*Y.AMOUNT,AktifSepet.push(Y)}document.getElementById("TOTALE_"+n).innerText=commaSplit(i),OrderFooter.TOTAL_PRICE+=i}var H=document.getElementById("genel_indirim_").value;H.length>0?(H=filterNum(commaSplit(H)),H=parseFloat(H),document.getElementById("genel_indirim_").value=commaSplit(H),OrderFooter.genel_indirim_=H):(document.getElementById("genel_indirim_").value=commaSplit(0),H=0,OrderFooter.genel_indirim_=H),OrderFooter.total_discount_wanted+=H,OrderFooter.brut_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted,OrderFooter.total_tax_wanted=0,OrderFooter.net_total_wanted=OrderFooter.total_default-OrderFooter.total_discount_wanted+OrderFooter.total_tax_wanted,OzetOlustur()}function GenerateUniqueId(){var e=new Date,t=e.toISOString().split("T")[0],n=e.toISOString().split("T")[1],a=t.replaceAll("-",""),r=n.replaceAll(":","");r=r.replaceAll(".",""),console.log(r);var o="PBS"+generalParamsSatis.userData.user_id+a+r;return o}function DegeriGetir(e,t,n=0,a=0){var r=$(e).find("input[name='"+t+"']").val();"SALE_PRICE"==t&&(console.log(e),console.log(r),console.log($(e).find("input[name='"+t+"']")));var o=0;if(r)0==n?o=r:1==n?o=parseInt(r):2==n&&(o=commaSplit(r).indexOf("NaN")>=0?parseFloat(filterNum(r)):parseFloat(filterNum(commaSplit(r))),"SALE_PRICE"==t&&console.log(o)),1==a&&(2!=n&&1!=n||$(e).find("input[name='"+t+"']").val(commaSplit(o)));else{r=$(e).find("select[name='"+t+"']").val();0==n?o=r:1==n?o=parseInt(r):2==n&&(o=parseFloat(filterNum(commaSplit(r))))}return o}function DegerYaz(e,t,n=0,a){var r=$(e).find("input[name='"+t+"']")[0],o=0;r?0==n?o=a:1==n?o=commaSplit(a):2==n&&(o=commaSplit(a)):(r=$(e).find("select[name='"+t+"']")[0],0==n?o=a:1==n?o=parseInt(a):2==n&&(o=parseFloat(filterNum(commaSplit(a))))),$(r).val(o)}function KurGetir(e){var t=MONEY_ARR.findIndex(t=>t.MONEY==e);return MONEY_ARR[t]}function OzetOlustur(){var e="<ul>",t=document.getElementById("BasketArea").children;for(let d=0;d<t.length;d++){var n=t[d],a=$(n).find("table"),r=a[0].children[0].cells;e+="<li><table class='table'><tr><td>";var o=n.getAttribute("data-proplist"),l=document.getElementById("SubSepetBody_"+o);for(let t=0;t<r.length;t++){var i=r[t];try{e+=i.lastChild.innerText+"->"}catch{}}e+="</td><td> "+l.children.length+"</</td></tr></table></li>"}e+="</ul>",$("#OzetAlani").html(e);var d=KurGetir(OfferData.OTHER_MONEY);$("#brut_total_wanted").val(commaSplit(OrderFooter.brut_total_wanted)),$("#brut_total_wanted_").val(commaSplit(OrderFooter.brut_total_wanted*d.RATE2)),$("#genel_indirim_").val(commaSplit(OrderFooter.genel_indirim_)),$("#genel_indirim__").val(commaSplit(OrderFooter.genel_indirim_*d.RATE2)),$("#net_total_wanted").val(commaSplit(OrderFooter.net_total_wanted)),$("#net_total_wanted_").val(commaSplit(OrderFooter.net_total_wanted*d.RATE2)),$("#total_default").val(commaSplit(OrderFooter.total_default)),$("#total_default_").val(commaSplit(OrderFooter.total_default*d.RATE2)),$("#total_discount_wanted").val(commaSplit(OrderFooter.total_discount_wanted)),$("#total_discount_wanted_").val(commaSplit(OrderFooter.total_discount_wanted*d.RATE2)),$("#total_tax_wanted").val(commaSplit(OrderFooter.total_tax_wanted)),$("#total_tax_wanted_").val(commaSplit(OrderFooter.total_tax_wanted*d.RATE2)),OrderFooter.brut_total_wanted_=OrderFooter.brut_total_wanted*d.RATE2,OrderFooter.genel_indirim__=OrderFooter.genel_indirim_*d.RATE2,OrderFooter.net_total_wanted_=OrderFooter.net_total_wanted*d.RATE2,OrderFooter.total_default_=OrderFooter.total_default*d.RATE2,OrderFooter.total_discount_wanted_=OrderFooter.total_discount_wanted*d.RATE2,OrderFooter.total_tax_wanted_=OrderFooter.total_tax_wanted*d.RATE2}function lookProducts(e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_products_pbs&proplist="+e)}function SaveOffer(){AlayiniHesapla();var e=new Object;e.OFFER_HEADER=OfferData,e.ROWS=AktifSepet,e.OFFER_FOOTER=OrderFooter,$.ajax({url:"/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=SAVE_OFFER_ROWS",data:{data:JSON.stringify(e)},type:"POST",success:function(e){$.notification(["Kayıt Edildi"],{messageType:"error"})}})}function get_consumer(e="",t=""){AjaxPageLoad("index.cfm?fuseaction=objects.emptypopup_get_company_partner&KEYWORD="+e.value,"text_cpm_search_result_area",1,"Yükleniyor")}function AddToCons(){var e=document.getElementsByName("comp_sel_cb"),t=document.getElementsByName("CBX");for(let I=0;I<e.length;I++){var n=e[I];if($(n).is(":checked")){var a=SelectedCompArr.findIndex(e=>e.COMPANY_ID==n.value),r=document.getElementById("comp_sel_mb_"+n.value).innerText,o=document.getElementById("comp_sel_nn_"+n.value).innerText;if(-1==a){var l={COMPANY_ID:n.value,NICKNAME:o,MEMBER_CODE:r,IS_PURCHASE_SAVED:0,P_PRICE_COUNT:0,OFFER_ID:0,PIDS:[]};for(let e=0;e<=t.length;e++)try{var i=t[e];if($(i).is(":checked")){var d=document.getElementById("PRODUCT_ID_"+(e+1)).value,u=document.getElementById("STOCK_ID_"+(e+1)).value,p=document.getElementById("PRODUCT_NAME_"+(e+1)).value,c=document.getElementById("PRODUCT_CODE_2_"+(e+1)).value,s=document.getElementById("QUANTITY_"+(e+1)).value,m=document.getElementById("UNIQUE_RELATION_ID_"+(e+1)).value,_=document.getElementById("PRODUCT_UNIT_"+(e+1)).value,E={PID:d,SID:u,QUANTITY:filterNum(s),UNIQUE_RELATION_ID:m,PRODUCT_NAME:p,PRODUCT_CODE_2:c,PRODUCT_UNIT:_,PRICE:0,PRICE_OTHER:0,OTHER_MONEY:""};l.PIDS.push(E)}}catch(e){}SelectedCompArr.push(l)}else for(let e=0;e<=t.length;e++)try{i=t[e];var C="PRODUCT_ID_"+(e+1);console.log(C);d=document.getElementById("PRODUCT_ID_"+(e+1)).value,u=document.getElementById("STOCK_ID_"+(e+1)).value,p=document.getElementById("PRODUCT_NAME_"+(e+1)).value,c=document.getElementById("PRODUCT_CODE_2_"+(e+1)).value,s=document.getElementById("QUANTITY_"+(e+1)).value,m=document.getElementById("UNIQUE_RELATION_ID_"+(e+1)).value,_=document.getElementById("PRODUCT_UNIT_"+(e+1)).value;if($(i).is(":checked")){var T=SelectedCompArr[a].PIDS.findIndex(e=>e.UNIQUE_RELATION_ID==m);if(-1==T){E={PID:d,SID:u,QUANTITY:filterNum(s),UNIQUE_RELATION_ID:m,PRODUCT_NAME:p,PRODUCT_CODE_2:c,PRODUCT_UNIT:_,PRICE:0,PRICE_OTHER:0,OTHER_MONEY:""};SelectedCompArr[a].PIDS.push(E)}}}catch(e){}}}TedarikYaz()}function TedarikYaz(){$("#tedarik").html("");for(let c=0;c<SelectedCompArr.length;c++){var e=SelectedCompArr[c];console.table(e);var t=document.createElement("table");t.setAttribute("class","table table-sm table-stripped"),t.setAttribute("style","border: solid 0.5px #d9d9d9;box-shadow: 1px 2px 20px 0px #cfc7c7;margin-top:5px !important;");var n=document.createElement("tr"),a=document.createElement("th");a.innerText=e.MEMBER_CODE,a.setAttribute("style","color:#fb6b5b;width:10%"),a.setAttribute("onclick","$('#tr_"+e.COMPANY_ID+"').toggle()"),n.appendChild(a);a=document.createElement("th");if(a.innerText=e.NICKNAME,0!=e.OFFER_ID){var r=document.createElement("span");r.setAttribute("class","fa fa-minus"),r.setAttribute("style","    float: right;margin-right: 10px; padding: 1px 8px 1px 8px;color:white;background:red"),r.setAttribute("onclick","windowopen('/index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=removePurchaseOffer&offer_id="+e.OFFER_ID+"')"),a.appendChild(r)}r=document.createElement("span");r.innerText=e.PIDS.length,r.setAttribute("style","    float: right;margin-right: 10px;  background: #fb6b5b;  color: white;  padding: 1px 8px 1px 8px;  border-radius: 50%;"),a.setAttribute("style","color:#fb6b5b"),a.appendChild(r);r=document.createElement("span");r.innerText=e.P_PRICE_COUNT,r.setAttribute("style","    float: right;margin-right: 10px;  background: #20a30a;  color: white;  padding: 1px 8px 1px 8px;  border-radius: 50%;"),e.PIDS.length==parseInt(e.P_PRICE_COUNT)&&a.setAttribute("style","color:#20a30a"),a.appendChild(r),n.appendChild(a),t.appendChild(n);n=document.createElement("tr"),a=document.createElement("td");a.setAttribute("colspan","2");var o=document.createElement("table");o.setAttribute("class","table table-sm table-stripped");var l=document.createElement("tr"),i=document.createElement("th");i.innerText="Part Number",l.appendChild(i);i=document.createElement("th");i.innerText="Product Name",l.appendChild(i);i=document.createElement("th");i.innerText="Amount",l.appendChild(i);i=document.createElement("th");i.innerText="Offered Prıce",l.appendChild(i);i=document.createElement("th");i.innerText="Money",l.appendChild(i),o.appendChild(l);for(let t=0;t<e.PIDS.length;t++){var d=e.PIDS[t],u=document.createElement("tr"),p=document.createElement("td");p.innerText=d.PRODUCT_CODE_2,u.appendChild(p);p=document.createElement("td");p.innerText=d.PRODUCT_NAME,u.appendChild(p);p=document.createElement("td");p.innerText=d.QUANTITY,u.appendChild(p);p=document.createElement("td");p.innerText=commaSplit(d.PRICE_OTHER),u.appendChild(p);p=document.createElement("td");p.innerText=d.OTHER_MONEY,u.appendChild(p),o.appendChild(u)}a.appendChild(o),n.appendChild(a),n.setAttribute("style","display:none"),n.id="tr_"+e.COMPANY_ID,t.appendChild(n),document.getElementById("tedarik").appendChild(t)}}function AddPurchaseOffer(){var e=getParameterByName("offer_id"),t={OFFER_ID:e,FormData:SelectedCompArr};$.ajax({url:"/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=AddPurchaseOffer",data:{FormData:JSON.stringify(t)},success:function(e){$.notification(["Kayıt Edildi"],{messageType:"error"})}})}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function loadRelOffers(){}function SavePropToShip(){var e=document.getElementById("WESSEL_ID").value;openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_list_ship_machine&WESSEL_ID="+e)}function ShowProperties(e){var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value,a=document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist");openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_hrz_pbs_smartTools&ListType=ShowProductProperties&rc="+t+"&PID="+n+"&prp_list="+a)}function ShowImages(e){var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value;document.getElementById("PRODUCT_CODE_2_"+t).getAttribute("proplist");openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_show_product_images&PRODUCT_ID="+n)}function ShowImages2(e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_show_product_images&PRODUCT_ID="+e)}function SatinAlmaKontrol(e){var t=[];SelectedCompArr=[],$.get("/AddOns/YafSatis/Partner/cfc/OfferService.cfc?method=getPurchaseOfferListForSaleOffer&OFFER_ID="+e).done(function(e){var n=JSON.parse(e);console.log(n);for(let e=0;e<n.length;e++){var a=n[e],r={COMPANY_ID:a.COMPANY_ID,NICKNAME:a.NICKNAME,MEMBER_CODE:a.MEMBER_CODE,IS_PURCHASE_SAVED:1,P_PRICE_COUNT:a.OFFER_ROWS.FIYAT_VERILEN,OFFER_ID:a.OFFER_ID,PIDS:[]};for(let e=0;e<a.OFFER_ROWS.ROWS.length;e++){var o=a.OFFER_ROWS.ROWS[e],l={PID:o.PRODUCT_ID,SID:o.STOCK_ID,QUANTITY:o.QUANTITY,UNIQUE_RELATION_ID:o.UNIQUE_RELATION_ID,PRODUCT_NAME:o.PRODUCT_NAME,PRODUCT_CODE_2:o.MANUFACT_CODE,PRODUCT_UNIT:o.MAIN_UNIT,PRICE:o.PRICE,PRICE_OTHER:o.PRICE_OTHER,OTHER_MONEY:o.OTHER_MONEY};r.PIDS.push(l)}t.push(r),SelectedCompArr.push(r)}console.log(SelectedCompArr),console.log(t),TedarikYaz()})}function open_product_popup(e){url_str="index.cfm?fuseaction=objects.popup_detail_product";var t=e.getAttribute("data-rc"),n=document.getElementById("PRODUCT_ID_"+t).value,a=document.getElementById("STOCK_ID_"+t).value,r=n,o=a;""!=o&&openBoxDraggable(url_str+"&pid="+o+"&sid="+r)}function CoppyOfferCanim(e,t){$.post(ServiceUri+"/OfferService.cfc?method=CopyOffer&OFFER_ID="+e+"&OFFER_NUMBER="+t).done(function(e){var t=JSON.parse(e);if(1==t.STATUS){var n=confirm("Kopyalama Başarılı Yeni Oluşan Teklife Gidilsinmi");n&&(window.location.href="/index.cfm?fuseaction=sale.emptypopup_hrz_pbs_sayfa3&offer_id="+t.OFFER_ID)}else alert("Bir Hata Oluştu")})}function open_product_popup_fg(e,t){url_str="index.cfm?fuseaction=objects.popup_detail_product";var n=e,a=t;""!=a&&openBoxDraggable(url_str+"&pid="+a+"&sid="+n)}function SessionKontrolPbs(){var e=window.location.search;e=e.substring(1,e.length),console.log(e),e=urlencode(e),console.log(e);var t=generalParamsSatis.userData.user_id,n=wrk_safe_query("SESSION_KONTROL_PBS","dsn",1,e+"*"+t);if(n.recordcount>0){$("#BUTON_1").hide(),$("#BUTON_2").hide(),$("#BUTON_3").hide(),$("#BUTON_4").hide(),$("#BUTON_5").hide(),$("#BUTON_6").hide();var a="Bu Sayfada Çalışan Var !";1==n.recordcount&&(a+="\n"+n.NAME[0]+" "+n.SURNAME[0]),alert(a)}}function urlencode(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function SepearatorSec(e){var t=e.parentElement.parentElement.parentElement.parentElement.parentElement.getAttribute("data-proplist");console.log(t);var n=document.getElementById("SubSepetBody_"+t);for(let e=0;e<n.children.length;e++){var a=n.children[e];console.log(a),$(a).find("input[name='CBX']").click()}}var RowCount=1,SeperatorSira=1,ServiceUri="/AddOns/YafSatis/Partner/cfc",paraBirimleri="";$(document).ready(function(){var e=document.getElementById("PRODUCT_CAT");paraBirimleri=wrk_safe_query("getMoneyList","dsn"),getCats(e),get_consumer("","")});var EqArr=[],AktifSepet=[],OfferSettings={IS_TAX_ZERO:1},OrderFooter={total_default:0,genel_indirim_:0,total_discount_wanted:0,brut_total_wanted:0,total_tax_wanted:0,net_total_wanted:0,other_money:"TL"},SelectedCompArr=[];